<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduktion til R: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduktion til R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduktion til R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduktion til R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">nu pr√∏ver vi</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Using Markdown</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="next-episode.html">2. next-episode-test</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="00-intro.html">3. Before we Start</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="01-intro-to-r.html">4. Introduction to R</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="02-starting-with-data.html">5. Starting with Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="03-dplyr-tidyr.html">6. Data Wrangling with dplyr and tidyr</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="04-functions-plots.html">7. A couple of plots. And making our own functions</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="05-whats-next.html">8. What is the next step?</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="ignore-04-ggplot2.html">9. Data Visualisation with ggplot2</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="ignore-05-databases.html">10. Using a relational database with R</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="ignore-05-json.html">11. Processing JSON data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
</ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Using Markdown</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/introduction.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with The Carpentries Workbench</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>This is a lesson created via The Carpentries Workbench. It is written
in <a href="https://pandoc.org/MANUAL.txt" class="external-link">Pandoc-flavored Markdown</a>
for static files and <a href="https://rmarkdown.rstudio.com/" class="external-link">R
Markdown</a> for dynamic files that can render code into output. Please
refer to the <a href="https://carpentries.github.io/sandpaper-docs/" class="external-link">Introduction to The
Carpentries Workbench</a> for full documentation.</p>
<p>What you need to know is that there are three sections required for a
valid Carpentries lesson:</p>
<ol style="list-style-type: decimal">
<li>
<code>questions</code> are displayed at the beginning of the episode
to prime the learner for the content.</li>
<li>
<code>objectives</code> are the learning objectives for an episode
displayed with the questions.</li>
<li>
<code>keypoints</code> are displayed at the end of the episode to
reinforce the objectives.</li>
</ol>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the ‚ÄúInstructor
View‚Äù</p>
</div>
</div>
</div>
</div>
<div id="challenge-1-can-you-do-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?<a class="anchor" aria-label="anchor" href="#challenge-1-can-you-do-it"></a>
</h3>
<div class="callout-content">
<p>What is the output of this command?</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="st">"This"</span>, <span class="st">"new"</span>, <span class="st">"lesson"</span>, <span class="st">"looks"</span>, <span class="st">"good"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Output</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "This new lesson looks good"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-2-how-do-you-nest-solutions-within-challenge-blocks" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-how-do-you-nest-solutions-within-challenge-blocks" class="callout-inner">
<h3 class="callout-title">Challenge 2: how do you nest solutions within
challenge blocks?<a class="anchor" aria-label="anchor" href="#challenge-2-how-do-you-nest-solutions-within-challenge-blocks"></a>
</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>You can add a line with at least three colons and a
<code>solution</code> tag.</p>
</div>
</div>
</div>
</div>
</section><section id="figures"><h2 class="section-heading">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h2>
<hr class="half-width">
<p>You can use standard markdown for static figures with the following
syntax:</p>
<p><code>![optional caption that appears below the figure](figure url){alt='alt text for accessibility purposes'}</code></p>
<figure><img src="https://raw.githubusercontent.com/carpentries/logo/master/Badge_Carpentries.svg" alt="Blue Carpentries hex person logo with no text." class="figure mx-auto d-block"><figcaption>You belong in The Carpentries!</figcaption></figure><div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>Callout sections can highlight information.</p>
<p>They are sometimes used to emphasise particularly important points
but are also used in some lessons to present ‚Äúasides‚Äù: content that is
not central to the narrative of the lesson, e.g.¬†by providing the answer
to a commonly-asked question.</p>
</div>
</div>
</div>
</section><section id="math"><h2 class="section-heading">Math<a class="anchor" aria-label="anchor" href="#math"></a>
</h2>
<hr class="half-width">
<p>One of our episodes contains <span class="math inline">\(\LaTeX\)</span> equations when describing how to
create dynamic reports with {knitr}, so we now use mathjax to describe
this:</p>
<p><code>$\alpha = \dfrac{1}{(1 - \beta)^2}$</code> becomes: <span class="math inline">\(\alpha = \dfrac{1}{(1 - \beta)^2}\)</span></p>
<p>Cool, right?</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-next-episode"><p>Content from <a href="next-episode.html">next-episode-test</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/next-episode.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you write a lesson using R Markdown and
<a href="https://carpentries.github.io/sandpaper/" class="external-link">sandpaper</a>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>This is a lesson created via The Carpentries Workbench. It is written
in <a href="https://pandoc.org/MANUAL.html" class="external-link">Pandoc-flavored Markdown</a>
for static files (with extension <code>.md</code>) and <a href="https://rmarkdown.rstudio.com/" class="external-link">R Markdown</a> for dynamic files
that can render code into output (with extension <code>.Rmd</code>).
Please refer to the <a href="https://carpentries.github.io/sandpaper-docs/" class="external-link">Introduction to The
Carpentries Workbench</a> for full documentation.</p>
<p>What you need to know is that there are three sections required for a
valid Carpentries lesson template:</p>
<ol style="list-style-type: decimal">
<li>
<code>questions</code> are displayed at the beginning of the episode
to prime the learner for the content.</li>
<li>
<code>objectives</code> are the learning objectives for an episode
displayed with the questions.</li>
<li>
<code>keypoints</code> are displayed at the end of the episode to
reinforce the objectives.</li>
</ol>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the ‚ÄúInstructor
View‚Äù</p>
</div>
</div>
</div>
</div>
<div id="challenge-1-can-you-do-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?<a class="anchor" aria-label="anchor" href="#challenge-1-can-you-do-it"></a>
</h3>
<div class="callout-content">
<p>What is the output of this command?</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="st">"This"</span>, <span class="st">"new"</span>, <span class="st">"lesson"</span>, <span class="st">"looks"</span>, <span class="st">"good"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Output</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "This new lesson looks good"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-2-how-do-you-nest-solutions-within-challenge-blocks" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-how-do-you-nest-solutions-within-challenge-blocks" class="callout-inner">
<h3 class="callout-title">Challenge 2: how do you nest solutions within
challenge blocks?<a class="anchor" aria-label="anchor" href="#challenge-2-how-do-you-nest-solutions-within-challenge-blocks"></a>
</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>You can add a line with at least three colons and a
<code>solution</code> tag.</p>
</div>
</div>
</div>
</div>
</section><section id="figures"><h2 class="section-heading">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h2>
<hr class="half-width">
<p>You can include figures generated from R Markdown:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pie</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span>Sky <span class="op">=</span> <span class="fl">78</span>, <span class="st">"Sunny side of pyramid"</span> <span class="op">=</span> <span class="fl">17</span>, <span class="st">"Shady side of pyramid"</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>  init.angle <span class="op">=</span> <span class="fl">315</span>, </span>
<span>  col <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"deepskyblue"</span>, <span class="st">"yellow"</span>, <span class="st">"yellow3"</span><span class="op">)</span>, </span>
<span>  border <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/next-episode-rendered-pyramid-1.png" alt="pie chart illusion of a pyramid" class="figure mx-auto d-block"><figcaption>
Sun arise each and every morning
</figcaption></figure><p>Or you can use pandoc markdown for static figures with the following
syntax:</p>
<p><code>![optional caption that appears below the figure](figure url){alt='alt text for accessibility purposes'}</code></p>
<figure><img src="https://raw.githubusercontent.com/carpentries/logo/master/Badge_Carpentries.svg" alt="Blue Carpentries hex person logo with no text." class="figure mx-auto d-block"><figcaption>You belong in The Carpentries!</figcaption></figure></section><section id="math"><h2 class="section-heading">Math<a class="anchor" aria-label="anchor" href="#math"></a>
</h2>
<hr class="half-width">
<p>One of our episodes contains <span class="math inline">\(\LaTeX\)</span> equations when describing how to
create dynamic reports with {knitr}, so we now use mathjax to describe
this:</p>
<p><code>$\alpha = \dfrac{1}{(1 - \beta)^2}$</code> becomes: <span class="math inline">\(\alpha = \dfrac{1}{(1 - \beta)^2}\)</span></p>
<p>Cool, right?</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-00-intro"><p>Content from <a href="00-intro.html">Before we Start</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/00-intro.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<ul>
<li>‚ÄúHow to find your way around RStudio?‚Äù</li>
<li>‚ÄúHow to interact with R?‚Äù</li>
<li>‚ÄúHow to manage your environment?‚Äù</li>
<li>‚ÄúHow to install packages?‚Äù</li>
</ul>
<p>questions:</p>
<p>objectives: - ‚ÄúInstall latest version of R.‚Äù - ‚ÄúInstall latest
version of RStudio.‚Äù - ‚ÄúNavigate the RStudio GUI.‚Äù - ‚ÄúInstall additional
packages using the packages tab.‚Äù - ‚ÄúInstall additional packages using R
code.‚Äù keypoints: - ‚ÄúUse RStudio to write and run R programs.‚Äù - ‚ÄúUse
<code>install.packages()</code> to install packages (libraries).‚Äù
source: Rmd</p>
<section id="what-is-r-what-is-rstudio"><h2 class="section-heading">What is R? What is RStudio?<a class="anchor" aria-label="anchor" href="#what-is-r-what-is-rstudio"></a>
</h2>
<hr class="half-width">
<p>The term ‚Äú<code>R</code>‚Äù is used to refer to both the programming
language and the software that interprets the scripts written using
it.</p>
<p><a href="https://rstudio.com" class="external-link">RStudio</a> is currently a very popular
way to not only write your R scripts but also to interact with the R
software. To function correctly, RStudio needs R and therefore both need
to be installed on your computer.</p>
<p>To make it easier to interact with R, we will use RStudio. RStudio is
the most popular IDE (Integrated Development Environmemt) for R. An IDE
is a piece of software that provides tools to make programming
easier.</p>
</section><section id="why-learn-r"><h2 class="section-heading">Why learn R?<a class="anchor" aria-label="anchor" href="#why-learn-r"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing">R does not involve lots of pointing and clicking, and that‚Äôs a good
thing<a class="anchor" aria-label="anchor" href="#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"></a>
</h3>
<p>The learning curve might be steeper than with other software, but
with R, the results of your analysis do not rely on remembering a
succession of pointing and clicking, but instead on a series of written
commands, and that‚Äôs a good thing! So, if you want to redo your analysis
because you collected more data, you don‚Äôt have to remember which button
you clicked in which order to obtain your results; you just have to run
your script again.</p>
<p>Working with scripts makes the steps you used in your analysis clear,
and the code you write can be inspected by someone else who can give you
feedback and spot mistakes.</p>
<p>Working with scripts forces you to have a deeper understanding of
what you are doing, and facilitates your learning and comprehension of
the methods you use.</p>
</div>
<div class="section level3">
<h3 id="r-code-is-great-for-reproducibility">R code is great for reproducibility<a class="anchor" aria-label="anchor" href="#r-code-is-great-for-reproducibility"></a>
</h3>
<p>Reproducibility is when someone else (including your future self) can
obtain the same results from the same dataset when using the same
analysis.</p>
<p>R integrates with other tools to generate manuscripts from your code.
If you collect more data, or fix a mistake in your dataset, the figures
and the statistical tests in your manuscript are updated
automatically.</p>
<p>An increasing number of journals and funding agencies expect analyses
to be reproducible, so knowing R will give you an edge with these
requirements.</p>
</div>
<div class="section level3">
<h3 id="r-is-interdisciplinary-and-extensible">R is interdisciplinary and extensible<a class="anchor" aria-label="anchor" href="#r-is-interdisciplinary-and-extensible"></a>
</h3>
<p>With 18,000+ packages that can be installed to extend its
capabilities, R provides a framework that allows you to combine
statistical approaches from many scientific disciplines to best suit the
analytical framework you need to analyze your data. For instance, R has
packages for image analysis, GIS, time series, population genetics, and
a lot more.</p>
</div>
<div class="section level3">
<h3 id="r-works-on-data-of-all-shapes-and-sizes">R works on data of all shapes and sizes<a class="anchor" aria-label="anchor" href="#r-works-on-data-of-all-shapes-and-sizes"></a>
</h3>
<p>The skills you learn with R scale easily with the size of your
dataset. Whether your dataset has hundreds or millions of lines, it
won‚Äôt make much difference to you.</p>
<p>R is designed for data analysis. It comes with special data
structures and data types that make handling of missing data and
statistical factors convenient.</p>
<p>R can connect to spreadsheets, databases, and many other data
formats, on your computer or on the web.</p>
</div>
<div class="section level3">
<h3 id="r-produces-high-quality-graphics">R produces high-quality graphics<a class="anchor" aria-label="anchor" href="#r-produces-high-quality-graphics"></a>
</h3>
<p>The plotting functionalities in R are endless, and allow you to
adjust any aspect of your graph to convey most effectively the message
from your data.</p>
</div>
<div class="section level3">
<h3 id="r-has-a-large-and-welcoming-community">R has a large and welcoming community<a class="anchor" aria-label="anchor" href="#r-has-a-large-and-welcoming-community"></a>
</h3>
<p>Thousands of people use R daily. Many of them are willing to help you
through mailing lists and websites such as <a href="https://stackoverflow.com/" class="external-link">Stack Overflow</a>, or on the <a href="https://community.rstudio.com/" class="external-link">RStudio community</a>. Questions
which are backed up with <a href="https://www.tidyverse.org/help/" class="external-link">short, reproducible code
snippets</a> are more likely to attract knowledgeable responses.</p>
</div>
<div class="section level3">
<h3 id="not-only-is-r-free-but-it-is-also-open-source-and-cross-platform">Not only is R free, but it is also open-source and
cross-platform<a class="anchor" aria-label="anchor" href="#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"></a>
</h3>
<p>Anyone can inspect the source code to see how R works. Because of
this transparency, there is less chance for mistakes, and if you (or
someone else) find some, you can report and fix bugs.</p>
<p>Because R is open source and is supported by a large community of
developers and users, there is a very large selection of third-party
add-on packages which are freely available to extend R‚Äôs native
capabilities.</p>
<figure><div class="row">
<div class="col-md-6">
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in knitr::include_graphics("../fig/r-manual.jpeg"): Cannot find the file(s): "../fig/r-manual.jpeg"</code></pre>
</div>
</div>
<div class="col-md-6">
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in knitr::include_graphics("../fig/r-automatic.jpeg"): Cannot find the file(s): "../fig/r-automatic.jpeg"</code></pre>
</div>
</div>
</div>
<figcaption>
RStudio extends what R can do, and makes it easier to write R code and
interact with R. <a href="https://unsplash.com/photos/D19rXKDUPYM" class="external-link">Left
photo credit</a>;
<a href="https://unsplash.com/photos/Wec3M4dY_LE" class="external-link">Right photo
credit</a>.
</figcaption></figure>
</div>
</section><section id="a-tour-of-rstudio"><h2 class="section-heading">A tour of RStudio<a class="anchor" aria-label="anchor" href="#a-tour-of-rstudio"></a>
</h2>
<hr class="half-width"></section><section id="knowing-your-way-around-rstudio"><h2 class="section-heading">Knowing your way around RStudio<a class="anchor" aria-label="anchor" href="#knowing-your-way-around-rstudio"></a>
</h2>
<hr class="half-width">
<p>Let‚Äôs start by learning about <a href="https://www.rstudio.com/" class="external-link">RStudio</a>, which is an Integrated
Development Environment (IDE) for working with R.</p>
<p>The RStudio IDE open-source product is free under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html" class="external-link">Affero General
Public License (AGPL) v3</a>. The RStudio IDE is also available with a
commercial license and priority email support from RStudio, Inc.</p>
<p>We will use the RStudio IDE to write code, navigate the files on our
computer, inspect the variables we create, and visualize the plots we
generate. RStudio can also be used for other things (e.g., version
control, developing packages, writing Shiny apps) that we will not cover
during the workshop.</p>
<p>One of the advantages of using RStudio is that all the information
you need to write code is available in a single window. Additionally,
RStudio provides many shortcuts, autocompletion, and highlighting for
the major file types you use while developing in R. RStudio makes typing
easier and less error-prone.</p>
</section><section id="getting-set-up"><h2 class="section-heading">Getting set up<a class="anchor" aria-label="anchor" href="#getting-set-up"></a>
</h2>
<hr class="half-width">
<p>It is good practice to keep a set of related data, analyses, and text
self-contained in a single folder called the <strong>working
directory</strong>. All of the scripts within this folder can then use
<em>relative paths</em> to files. Relative paths indicate where inside
the project a file is located (as opposed to absolute paths, which point
to where a file is on a specific computer). Working this way makes it a
lot easier to move your project around on your computer and share it
with others without having to directly modify file paths in the
individual scripts.</p>
<p>RStudio provides a helpful set of tools to do this through its
‚ÄúProjects‚Äù interface, which not only creates a working directory for you
but also remembers its location (allowing you to quickly navigate to
it). The interface also (optionally) preserves custom settings and open
files to make it easier to resume work after a break.</p>
<div class="section level3">
<h3 id="create-a-new-project">Create a new project<a class="anchor" aria-label="anchor" href="#create-a-new-project"></a>
</h3>
<ul>
<li>Under the <code>File</code> menu, click on <code>New project</code>,
choose <code>New directory</code>, then <code>New project</code>
</li>
<li>Enter a name for this new folder (or ‚Äúdirectory‚Äù) and choose a
convenient location for it. This will be your <strong>working
directory</strong> for the rest of the day (e.g.,
<code>~/data-carpentry</code>)</li>
<li>Click on <code>Create project</code>
</li>
<li>Create a new file where we will type our scripts. Go to File &gt;
New File &gt; R script. Click the save icon on your toolbar and save
your script as ‚Äú<code>script.R</code>‚Äù.</li>
</ul>
<p>The simplest way to open an RStudio project once it has been created
is to navigate through your files to where the project was saved and
double click on the <code>.Rproj</code> (blue cube) file. This will open
RStudio and start your R session in the <strong>same</strong> directory
as the <code>.Rproj</code> file. All your data, plots and scripts will
now be relative to the project directory. RStudio projects have the
added benefit of allowing you to open multiple projects at the same time
each open to its own project directory. This allows you to keep multiple
projects open without them interfering with each other.</p>
</div>
<div class="section level3">
<h3 id="the-rstudio-interface">The RStudio Interface<a class="anchor" aria-label="anchor" href="#the-rstudio-interface"></a>
</h3>
<p>Let‚Äôs take a quick tour of RStudio.</p>
<figure><img src="../fig/R_00_Rstudio_01.png" alt="" class="figure mx-auto d-block"><figcaption>RStudio_startup</figcaption></figure><p>RStudio is divided into four ‚Äúpanes‚Äù. The placement of these panes
and their content can be customized (see menu, Tools -&gt; Global
Options -&gt; Pane Layout).</p>
<p>The Default Layout is: - Top Left - <strong>Source</strong>: your
scripts and documents - Bottom Left - <strong>Console</strong>: what R
would look and be like without RStudio - Top Right -
<strong>Enviornment/History</strong>: look here to see what you have
done - Bottom Right - <strong>Files</strong> and more: see the contents
of the project/working directory here, like your Script.R file</p>
</div>
<div class="section level3">
<h3 id="organizing-your-working-directory">Organizing your working directory<a class="anchor" aria-label="anchor" href="#organizing-your-working-directory"></a>
</h3>
<p>Using a consistent folder structure across your projects will help
keep things organized and make it easy to find/file things in the
future. This can be especially helpful when you have multiple projects.
In general, you might create directories (folders) for
<strong>scripts</strong>, <strong>data</strong>, and
<strong>documents</strong>. Here are some examples of suggested
directories:</p>
<ul>
<li>
<strong><code>data/</code></strong> Use this folder to store your
raw data and intermediate datasets. For the sake of transparency and <a href="https://en.wikipedia.org/wiki/Provenance" class="external-link">provenance</a>, you
should <em>always</em> keep a copy of your raw data accessible and do as
much of your data cleanup and preprocessing programmatically (i.e., with
scripts, rather than manually) as possible.</li>
<li>
<strong><code>data_output/</code></strong> When you need to modify
your raw data, it might be useful to store the modified versions of the
datasets in a different folder.</li>
<li>
<strong><code>documents/</code></strong> Used for outlines, drafts,
and other text.</li>
<li>
<strong><code>fig_output/</code></strong> This folder can store the
graphics that are generated by your scripts.</li>
<li>
<strong><code>scripts/</code></strong> A place to keep your R
scripts for different analyses or plotting.</li>
</ul>
<p>You may want additional directories or subdirectories depending on
your project needs, but these should form the backbone of your working
directory.</p>
<figure><img src="../fig/rstudio_project_files.jpeg" alt="" class="figure mx-auto d-block"><figcaption>Example of a working directory structure</figcaption></figure>
</div>
<div class="section level3">
<h3 id="the-working-directory">The working directory<a class="anchor" aria-label="anchor" href="#the-working-directory"></a>
</h3>
<p>The working directory is an important concept to understand. It is
the place where R will look for and save files. When you write code for
your project, your scripts should refer to files in relation to the root
of your working directory and only to files within this structure.</p>
<p>Using RStudio projects makes this easy and ensures that your working
directory is set up properly. If you need to check it, you can use
<code>getwd()</code>. If for some reason your working directory is not
the same as the location of your RStudio project, it is likely that you
opened an R script or RMarkdown file <strong>not</strong> your
<code>.Rproj</code> file. You should close out of RStudio and open the
<code>.Rproj</code> file by double clicking on the blue cube!</p>
</div>
<div class="section level3">
<h3 id="downloading-the-data-and-getting-set-up">Downloading the data and getting set up<a class="anchor" aria-label="anchor" href="#downloading-the-data-and-getting-set-up"></a>
</h3>
<p>For this lesson we will use the following folders in our working
directory: <strong><code>data/</code></strong>,
<strong><code>data_output/</code></strong> and
<strong><code>fig_output/</code></strong>. Let‚Äôs write them all in
lowercase to be consistent. We can create them using the RStudio
interface by clicking on the ‚ÄúNew Folder‚Äù button in the file pane
(bottom right), or directly from R by typing at console:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span></span>
<span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"data_output"</span><span class="op">)</span></span>
<span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"fig_output"</span><span class="op">)</span></span></code></pre>
</div>
<p>Begin by downloading the dataset called
‚Äú<code>SAFI_clean.csv</code>‚Äù. The direct download link is: <a href="https://raw.githubusercontent.com/KUBDatalab/beginning-R/main/data/SAFI_clean.csv" class="external-link uri">https://raw.githubusercontent.com/KUBDatalab/beginning-R/main/data/SAFI_clean.csv</a>.
Place this downloaded file in the <code>data/</code> you just created.
You can do this directly from R by copying and pasting this in your
terminal (your instructor can place this chunk of code in the
Etherpad):</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KUBDatalab/beginning-R/main/data/SAFI_clean.csv"</span>,</span>
<span>              <span class="st">"data/SAFI_clean.csv"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</section><section id="interacting-with-r"><h2 class="section-heading">Interacting with R<a class="anchor" aria-label="anchor" href="#interacting-with-r"></a>
</h2>
<hr class="half-width">
<p>The basis of programming is that we write down instructions for the
computer to follow, and then we tell the computer to follow those
instructions. We write, or <em>code</em>, instructions in R because it
is a common language that both the computer and we can understand. We
call the instructions <em>commands</em> and we tell the computer to
follow the instructions by <em>executing</em> (also called
<em>running</em>) those commands.</p>
<p>There are two main ways of interacting with R: by using the console
or by using script files (plain text files that contain your code). The
console pane (in RStudio, the bottom left panel) is the place where
commands written in the R language can be typed and executed immediately
by the computer. It is also where the results will be shown for commands
that have been executed. You can type commands directly into the console
and press <kbd>Enter</kbd> to execute those commands, but they will be
forgotten when you close the session.</p>
<p>Because we want our code and workflow to be reproducible, it is
better to type the commands we want in the script editor and save the
script. This way, there is a complete record of what we did, and anyone
(including our future selves!) can easily replicate the results on their
computer.</p>
<p>RStudio allows you to execute commands directly from the script
editor by using the <kbd>Ctrl</kbd> + <kbd>Enter</kbd> shortcut (on Mac,
<kbd>Cmd</kbd> + <kbd>Return</kbd> will work). The command on the
current line in the script (indicated by the cursor) or all of the
commands in selected text will be sent to the console and executed when
you press <kbd>Ctrl</kbd> + <kbd>Enter</kbd>. If there is information in
the console you do not need anymore, you can clear it with
<kbd>Ctrl</kbd> + <kbd>L</kbd>. You can find other keyboard shortcuts in
this <a href="https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf" class="external-link">RStudio
cheatsheet about the RStudio IDE</a>.</p>
<p>At some point in your analysis, you may want to check the content of
a variable or the structure of an object without necessarily keeping a
record of it in your script. You can type these commands and execute
them directly in the console. RStudio provides the <kbd>Ctrl</kbd> +
<kbd>1</kbd> and <kbd>Ctrl</kbd> + <kbd>2</kbd> shortcuts allow you to
jump between the script and the console panes.</p>
<p>If R is ready to accept commands, the R console shows a
<code>&gt;</code> prompt. If R receives a command (by typing,
copy-pasting, or sent from the script editor using <kbd>Ctrl</kbd> +
<kbd>Enter</kbd>), R will try to execute it and, when ready, will show
the results and come back with a new <code>&gt;</code> prompt to wait
for new commands.</p>
<p>If R is still waiting for you to enter more text, the console will
show a <code>+</code> prompt. It means that you haven‚Äôt finished
entering a complete command. This is likely because you have not
‚Äòclosed‚Äô a parenthesis or quotation, i.e.¬†you don‚Äôt have the same number
of left-parentheses as right-parentheses or the same number of opening
and closing quotation marks. When this happens, and you thought you
finished typing your command, click inside the console window and press
<kbd>Esc</kbd>; this will cancel the incomplete command and return you
to the <code>&gt;</code> prompt. You can then proofread the command(s)
you entered and correct the error.</p>
</section><section id="installing-additional-packages-using-the-packages-tab"><h2 class="section-heading">Installing additional packages using the packages tab<a class="anchor" aria-label="anchor" href="#installing-additional-packages-using-the-packages-tab"></a>
</h2>
<hr class="half-width">
<p>In addition to the core R installation, there are in excess of 18,000
additional packages which can be used to extend the functionality of R.
Many of these have been written by R users and have been made available
in central repositories, like the one hosted at CRAN, for anyone to
download and install into their own R environment. You should have
already installed the packages ‚Äòggplot2‚Äô and ‚Äôdplyr. If you have not,
please do so now using these instructions.</p>
<p>You can see if you have a package installed by looking in the
<code>packages</code> tab (on the lower-right by default). You can also
type the command <code>installed.packages()</code> into the console and
examine the output.</p>
<figure><img src="../fig/packages_pane.png" alt="" class="figure mx-auto d-block"><figcaption>Packages pane</figcaption></figure><p>Additional packages can be installed from the ‚Äòpackages‚Äô tab. On the
packages tab, click the ‚ÄòInstall‚Äô icon and start typing the name of the
package you want in the text box. As you type, packages matching your
starting characters will be displayed in a drop-down list so that you
can select them.</p>
<figure><img src="../fig/R_00_Rstudio_03.png" alt="" class="figure mx-auto d-block"><figcaption>Install Packages Window</figcaption></figure><p>At the bottom of the Install Packages window is a check box to
‚ÄòInstall‚Äô dependencies. This is ticked by default, which is usually what
you want. Packages can (and do) make use of functionality built into
other packages, so for the functionality contained in the package you
are installing to work properly, there may be other packages which have
to be installed with them. The ‚ÄòInstall dependencies‚Äô option makes sure
that this happens.</p>
<blockquote>
<h2 id="exercise">Exercise</h2>
<p>Use both the Console and the Packages tab to confirm that you have
the tidyverse installed.</p>
<blockquote>
<h2 id="solution">Solution</h2>
<p>Scroll through packages tab down to ‚Äòtidyverse‚Äô. You can also type a
few characters into the searchbox. The ‚Äòtidyverse‚Äô package is really a
package of packages, including ‚Äòggplot2‚Äô and ‚Äòdplyr‚Äô, both of which
require other packages to run correctly. All of these packages will be
installed automatically. Depending on what packages have previously been
installed in your R environment, the install of ‚Äòtidyverse‚Äô could be
very quick or could take several minutes. As the install proceeds,
messages relating to its progress will be written to the console. You
will be able to see all of the packages which are actually being
installed. {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>Because the install process accesses the CRAN repository, you will
need an Internet connection to install packages.</p>
<p>It is also possible to install packages from other repositories, as
well as Github or the local file system, but we won‚Äôt be looking at
these options in this lesson.</p>
</section><section id="installing-additional-packages-using-r-code"><h2 class="section-heading">Installing additional packages using R code<a class="anchor" aria-label="anchor" href="#installing-additional-packages-using-r-code"></a>
</h2>
<hr class="half-width">
<p>If you were watching the console window when you started the install
of ‚Äòtidyverse‚Äô, you may have noticed that the line</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre>
</div>
<p>was written to the console before the start of the installation
messages.</p>
<p>You could also have installed the
<strong><code>tidyverse</code></strong> packages by running this command
directly at the R terminal.</p>
<p>{% include links.md %}</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-01-intro-to-r"><p>Content from <a href="01-intro-to-r.html">Introduction to R</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/01-intro-to-r.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="creating-objects-in-r"><h2 class="section-heading">Creating objects in R<a class="anchor" aria-label="anchor" href="#creating-objects-in-r"></a>
</h2>
<hr class="half-width">
<p>You can get output from R simply by typing math in the console:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">12</span> <span class="op">/</span> <span class="fl">7</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.714286</code></pre>
</div>
<p>However, to do useful and interesting things, we need to assign
<em>values</em> to <em>objects</em>. To create an object, we need to
give it a name followed by the assignment operator <code>&lt;-</code>,
and the value we want to give it:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span></code></pre>
</div>
<p><code>&lt;-</code> is the assignment operator. It assigns values on
the right to objects on the left. So, after executing
<code>x &lt;- 3</code>, the value of <code>x</code> is <code>3</code>.
The arrow can be read as 3 <strong>goes into</strong> <code>x</code>.
For historical reasons, you can also use <code>=</code> for assignments,
but not in every context. Because of the <a href="https://web.archive.org/web/20210121015950/https://blog.revolutionanalytics.com/2008/12/use-equals-or-arrow-for-assignment.html" class="external-link">slight</a>
<a href="https://web.archive.org/web/20210810114254/https://stackoverflow.com/questions/1741820/what-are-the-differences-between-and-assignment-operators-in-r" class="external-link">differences</a>
in syntax, it is good practice to always use <code>&lt;-</code> for
assignments. More generally we prefer the <code>&lt;-</code> syntax over
<code>=</code> because it makes it clear what direction the assignment
is operating (left assignment), and it increases the read-ability of the
code.</p>
<p>In RStudio, typing <kbd>Alt</kbd> + <kbd>-</kbd> (push <kbd>Alt</kbd>
at the same time as the <kbd>-</kbd> key) will write <code>&lt;-</code>
in a single keystroke in a PC, while typing <kbd>Option</kbd> +
<kbd>-</kbd> (push <kbd>Option</kbd> at the same time as the
<kbd>-</kbd> key) does the same in a Mac.</p>
<p>Objects can be given any name such as <code>x</code>,
<code>current_temperature</code>, or <code>subject_id</code>. You want
your object names to be explicit and not too long. They cannot start
with a number (<code>2x</code> is not valid, but <code>x2</code> is). R
is case sensitive (e.g., <code>age</code> is different from
<code>Age</code>). There are some names that cannot be used because they
are the names of fundamental objects in R (e.g., <code>if</code>,
<code>else</code>, <code>for</code>, see <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Reserved.html" class="external-link">here</a>
for a complete list). In general, even if it‚Äôs allowed, it‚Äôs best to not
use them (e.g., <code>c</code>, <code>T</code>, <code>mean</code>,
<code>data</code>, <code>df</code>, <code>weights</code>). If in doubt,
check the help to see if the name is already in use. It‚Äôs also best to
avoid dots (<code>.</code>) within an object name as in
<code>my.dataset</code>. There are many objects in R with dots in their
names for historical reasons, but because dots have a special meaning in
R (for methods) and other programming languages, it‚Äôs best to avoid
them. It is also recommended to use nouns for object names, and verbs
for function names. It‚Äôs important to be consistent in the styling of
your code (where you put spaces, how you name objects, etc.). Using a
consistent coding style makes your code clearer to read for your future
self and your collaborators. In R, three popular style guides are <a href="https://google.github.io/styleguide/Rguide.xml" class="external-link">Google‚Äôs</a>, <a href="http://jef.works/R-style-guide/" class="external-link">Jean Fan‚Äôs</a> and the <a href="http://style.tidyverse.org/" class="external-link">tidyverse‚Äôs</a>. The tidyverse‚Äôs is
very comprehensive and may seem overwhelming at first. You can install
the <a href="https://github.com/jimhester/lintr" class="external-link"><strong><code>lintr</code></strong></a>
package to automatically check for issues in the styling of your
code.</p>
<blockquote>
<h2 id="objects-vs.-variables">Objects vs.¬†variables</h2>
<p>What are known as <code>objects</code> in <code>R</code> are known as
<code>variables</code> in many other programming languages. Depending on
the context, <code>object</code> and <code>variable</code> can have
drastically different meanings. However, in this lesson, the two words
are used synonymously. For more information see: <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Objects" class="external-link">https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Objects</a>
{: .callout}</p>
</blockquote>
<p>When assigning a value to an object, R does not print anything. You
can force R to print the value by using parentheses or by typing the
object name:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span>    <span class="co"># doesn't print anything</span></span>
<span><span class="op">(</span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span><span class="op">)</span>  <span class="co"># putting parenthesis around the call prints the value of `area_hectares`</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span>         <span class="co"># and so does typing the name of the object</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<p>Now that R has <code>area_hectares</code> in memory, we can do
arithmetic with it. For instance, we may want to convert this area into
acres (area in acres is 2.47 times the area in hectares):</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2.47</span> <span class="op">*</span> <span class="va">area_hectares</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.47</code></pre>
</div>
<p>We can also change an object‚Äôs value by assigning it a new one:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="fl">2.47</span> <span class="op">*</span> <span class="va">area_hectares</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6.175</code></pre>
</div>
<p>This means that assigning a value to one object does not change the
values of other objects. For example, let‚Äôs store the plot‚Äôs area in
acres in a new object, <code>area_acres</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_acres</span> <span class="op">&lt;-</span> <span class="fl">2.47</span> <span class="op">*</span> <span class="va">area_hectares</span></span></code></pre>
</div>
<p>and then change <code>area_hectares</code> to 50.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></code></pre>
</div>
<blockquote>
<h2 id="exercise">Exercise</h2>
<p>What do you think is the current content of the object
<code>area_acres</code>? 123.5 or 6.175?</p>
<blockquote>
<h2 id="solution">Solution</h2>
<p>The value of <code>area_acres</code> is still 6.175 because you have
not re-run the line <code>area_acres &lt;- 2.47 * area_hectares</code>
since changing the value of <code>area_hectares</code>. {: .solution} {:
.challenge}</p>
</blockquote>
</blockquote>
</section><section id="comments"><h2 class="section-heading">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h2>
<hr class="half-width">
<p>All programming languages allow the programmer to include comments in
their code. To do this in R we use the <code>#</code> character.
Anything to the right of the <code>#</code> sign and up to the end of
the line is treated as a comment and is ignored by R. You can start
lines with comments or include them after any code on the line.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area_hectares</span> <span class="op">&lt;-</span> <span class="fl">1.0</span>      <span class="co"># land area in hectares</span></span>
<span><span class="va">area_acres</span> <span class="op">&lt;-</span> <span class="va">area_hectares</span> <span class="op">*</span> <span class="fl">2.47</span>  <span class="co"># convert to acres</span></span>
<span><span class="va">area_acres</span>        <span class="co"># print land area in acres.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.47</code></pre>
</div>
<p>RStudio makes it easy to comment or uncomment a paragraph: after
selecting the lines you want to comment, press at the same time on your
keyboard <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd>. If you only
want to comment out one line, you can put the cursor at any location of
that line (i.e.¬†no need to select the whole line), then press
<kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd>.</p>
<blockquote>
<h2 id="exercise-1">Exercise</h2>
<p>Create two variables <code>r_length</code> and <code>r_width</code>
and assign them values. It should be noted that, because
<code>length</code> is a built-in R function, R Studio might add ‚Äú()‚Äù
after you type <code>length</code> and if you leave the parentheses you
will get unexpected results. This is why you might see other programmers
abbreviate common words. Create a third variable <code>r_area</code> and
give it a value based on the current values of <code>r_length</code> and
<code>r_width</code>. Show that changing the values of either
<code>r_length</code> and <code>r_width</code> does not affect the value
of <code>r_area</code>.</p>
<blockquote>
<h2 id="solution-1">Solution</h2>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_length</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">r_width</span> <span class="op">&lt;-</span> <span class="fl">3.2</span></span>
<span><span class="va">r_area</span> <span class="op">&lt;-</span> <span class="va">r_length</span> <span class="op">*</span> <span class="va">r_width</span></span>
<span><span class="va">r_area</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change the values of r_length and r_width</span></span>
<span><span class="va">r_length</span> <span class="op">&lt;-</span> <span class="fl">7.0</span></span>
<span><span class="va">r_width</span> <span class="op">&lt;-</span> <span class="fl">6.5</span></span>
<span><span class="co"># the value of r_area isn't changed</span></span>
<span><span class="va">r_area</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8</code></pre>
</div>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<div class="section level3">
<h3 id="functions-and-their-arguments">Functions and their arguments<a class="anchor" aria-label="anchor" href="#functions-and-their-arguments"></a>
</h3>
<p>Functions are ‚Äúcanned scripts‚Äù that automate more complicated sets of
commands including operations assignments, etc. Many functions are
predefined, or can be made available by importing R <em>packages</em>
(more on that later). A function usually gets one or more inputs called
<em>arguments</em>. Functions often (but not always) return a
<em>value</em>. A typical example would be the function
<code>sqrt()</code>. The input (the argument) must be a number, and the
return value (in fact, the output) is the square root of that number.
Executing a function (‚Äòrunning it‚Äô) is called <em>calling</em> the
function. An example of a function call is:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre>
</div>
<p>Here, the value of <code>a</code> is given to the <code>sqrt()</code>
function, the <code>sqrt()</code> function calculates the square root,
and returns the value which is then assigned to the object
<code>b</code>. This function is very simple, because it takes just one
argument.</p>
<p>The return ‚Äòvalue‚Äô of a function need not be numerical (like that of
<code>sqrt()</code>), and it also does not need to be a single item: it
can be a set of things, or even a dataset. We‚Äôll see that when we read
data files into R.</p>
<p>Arguments can be anything, not only numbers or filenames, but also
other objects. Exactly what each argument means differs per function,
and must be looked up in the documentation (see below). Some functions
take arguments which may either be specified by the user, or, if left
out, take on a <em>default</em> value: these are called
<em>options</em>. Options are typically used to alter the way the
function operates, such as whether it ignores ‚Äòbad values‚Äô, or what
symbol to use in a plot. However, if you want something specific, you
can specify a value of your choice which will be used instead of the
default.</p>
<p>Let‚Äôs try a function that can take multiple arguments:
<code>round()</code>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>Here, we‚Äôve called <code>round()</code> with just one argument,
<code>3.14159</code>, and it has returned the value <code>3</code>.
That‚Äôs because the default is to round to the nearest whole number. If
we want more digits we can see how to do that by getting information
about the <code>round</code> function. We can use
<code>args(round)</code> or look at the help for this function using
<code>?round</code>.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">args</span><span class="op">(</span><span class="va">round</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="cn">NULL</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">round</span></span></code></pre>
</div>
<p>We see that if we want a different number of digits, we can type
<code>digits=2</code> or however many we want.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>If you provide the arguments in the exact same order as they are
defined you don‚Äôt have to name them:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span><span class="fl">3.14159</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>And if you do name the arguments, you can switch their order:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">round</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, x <span class="op">=</span> <span class="fl">3.14159</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.14</code></pre>
</div>
<p>It‚Äôs good practice to put the non-optional arguments (like the number
you‚Äôre rounding) first in your function call, and to specify the names
of all optional arguments. If you don‚Äôt, someone reading your code might
have to look up the definition of a function with unfamiliar arguments
to understand what you‚Äôre doing.</p>
<blockquote>
<h2 id="exercise-2">Exercise</h2>
<p>Type in <code>?round</code> at the console and then look at the
output in the Help pane. What other functions exist that are similar to
<code>round</code>? How do you use the <code>digits</code> parameter in
the round function? {: .challenge}</p>
</blockquote>
</div>
</section><section id="vectors-and-data-types"><h2 class="section-heading">Vectors and data types<a class="anchor" aria-label="anchor" href="#vectors-and-data-types"></a>
</h2>
<hr class="half-width">
<p>A vector is the most common and basic data type in R, and is pretty
much the workhorse of R. A vector is composed by a series of values,
which can be either numbers or characters. We can assign a series of
values to a vector using the <code>c()</code> function. For example we
can create a vector of the number of household members for the
households we‚Äôve interviewed and assign it to a new object
<code>hh_members</code>:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">hh_members</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  3  7 10  6</code></pre>
</div>
<p>A vector can also contain characters. For example, we can have a
vector of the building material used to construct our interview
respondents‚Äô walls (<code>respondent_wall_type</code>):</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_wall_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"muddaub"</span>, <span class="st">"burntbricks"</span>, <span class="st">"sunbricks"</span><span class="op">)</span></span>
<span><span class="va">respondent_wall_type</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "muddaub"     "burntbricks" "sunbricks"  </code></pre>
</div>
<p>The quotes around ‚Äúmuddaub‚Äù, etc. are essential here. Without the
quotes R will assume there are objects called <code>muddaub</code>,
<code>burntbricks</code> and <code>sunbricks</code>. As these objects
don‚Äôt exist in R‚Äôs memory, there will be an error message.</p>
<p>There are many functions that allow you to inspect the content of a
vector. <code>length()</code> tells you how many elements are in a
particular vector:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">hh_members</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<p>An important feature of a vector, is that all of the elements are the
same type of data. The function <code>class()</code> indicates the class
(the type of element) of an object:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">hh_members</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "numeric"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<p>The function <code>str()</code> provides an overview of the structure
of an object and its elements. It is a useful function when working with
large and complex objects:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">hh_members</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:4] 3 7 10 6</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "muddaub" "burntbricks" "sunbricks"</code></pre>
</div>
<p>You can use the <code>c()</code> function to add other elements to
your vector:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"bicycle"</span>, <span class="st">"radio"</span>, <span class="st">"television"</span><span class="op">)</span></span>
<span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">possessions</span>, <span class="st">"mobile_phone"</span><span class="op">)</span> <span class="co"># add to the end of the vector</span></span>
<span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="va">possessions</span><span class="op">)</span> <span class="co"># add to the beginning of the vector</span></span>
<span><span class="va">possessions</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "car"          "bicycle"      "radio"        "television"   "mobile_phone"</code></pre>
</div>
<p>In the first line, we take the original vector
<code>possessions</code>, add the value <code>"mobile_phone"</code> to
the end of it, and save the result back into <code>possessions</code>.
Then we add the value <code>"car"</code> to the beginning, again saving
the result back into <code>possessions</code>.</p>
<p>We can do this over and over again to grow a vector, or assemble a
dataset. As we program, this may be useful to add results that we are
collecting or calculating.</p>
<p>An <strong>atomic vector</strong> is the simplest R <strong>data
type</strong> and is a linear vector of a single type. Above, we saw 2
of the 6 main <strong>atomic vector</strong> types that R uses:
<code>"character"</code> and <code>"numeric"</code> (or
<code>"double"</code>). These are the basic building blocks that all R
objects are built from. The other 4 <strong>atomic vector</strong> types
are:</p>
<ul>
<li>
<code>"logical"</code> for <code>TRUE</code> and <code>FALSE</code>
(the boolean data type)</li>
<li>
<code>"integer"</code> for integer numbers (e.g., <code>2L</code>,
the <code>L</code> indicates to R that it‚Äôs an integer)</li>
<li>
<code>"complex"</code> to represent complex numbers with real and
imaginary parts (e.g., <code>1 + 4i</code>) and that‚Äôs all we‚Äôre going
to say about them</li>
<li>
<code>"raw"</code> for bitstreams that we won‚Äôt discuss further</li>
</ul>
<p>You can check the type of your vector using the <code>typeof()</code>
function and inputting your vector as the argument.</p>
<p>Vectors are one of the many <strong>data structures</strong> that R
uses. Other important ones are lists (<code>list</code>), matrices
(<code>matrix</code>), data frames (<code>data.frame</code>), factors
(<code>factor</code>) and arrays (<code>array</code>).</p>
<blockquote>
<h2 id="exercise-3">Exercise</h2>
<p>We‚Äôve seen that atomic vectors can be of type character, numeric (or
double), integer, and logical. But what happens if we try to mix these
types in a single vector?</p>
<blockquote>
<h2 id="solution-2">Solution</h2>
<p>R implicitly converts them to all be the same type. {: .solution}</p>
</blockquote>
<p>What will happen in each of these examples? (hint: use
<code>class()</code> to check the data type of your objects):</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_char</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">num_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">char_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tricky</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="st">"4"</span><span class="op">)</span></span></code></pre>
</div>
<p>Why do you think it happens?</p>
<blockquote>
<h2 id="solution-3">Solution</h2>
<p>Vectors can be of only one data type. R tries to convert (coerce) the
content of this vector to find a ‚Äúcommon denominator‚Äù that doesn‚Äôt lose
any information. {: .solution}</p>
</blockquote>
<p>How many values in <code>combined_logical</code> are
<code>"TRUE"</code> (as a character) in the following example:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">char_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">combined_logical</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">num_logical</span>, <span class="va">char_logical</span><span class="op">)</span></span></code></pre>
</div>
<p>¬†</p>
<blockquote>
<h2 id="solution-4">Solution</h2>
<p>Only one. There is no memory of past data types, and the coercion
happens the first time the vector is evaluated. Therefore, the
<code>TRUE</code> in <code>num_logical</code> gets converted into a
<code>1</code> before it gets converted into <code>"1"</code> in
<code>combined_logical</code>. {: .solution}</p>
</blockquote>
<p>You‚Äôve probably noticed that objects of different types get converted
into a single, shared type within a vector. In R, we call converting
objects from one class into another class <em>coercion</em>. These
conversions happen according to a hierarchy, whereby some types get
preferentially coerced into other types. Can you draw a diagram that
represents the hierarchy of how these data types are coerced?</p>
<p>{: .challenge}</p>
</blockquote>
</section><section id="subsetting-vectors"><h2 class="section-heading">Subsetting vectors<a class="anchor" aria-label="anchor" href="#subsetting-vectors"></a>
</h2>
<hr class="half-width">
<p>If we want to extract one or several values from a vector, we must
provide one or several indices in square brackets. For instance:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_wall_type</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"muddaub"</span>, <span class="st">"burntbricks"</span>, <span class="st">"sunbricks"</span><span class="op">)</span></span>
<span><span class="va">respondent_wall_type</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "burntbricks"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">respondent_wall_type</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "sunbricks"   "burntbricks"</code></pre>
</div>
<p>We can also repeat the indices to create an object with more elements
than the original one:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">more_respondent_wall_type</span> <span class="op">&lt;-</span> <span class="va">respondent_wall_type</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">more_respondent_wall_type</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "muddaub"     "burntbricks" "sunbricks"   "burntbricks" "muddaub"    
[6] "sunbricks"  </code></pre>
</div>
<p>R indices start at 1. Programming languages like Fortran, MATLAB,
Julia, and R start counting at 1, because that‚Äôs what human beings
typically do. Languages in the C family (including C++, Java, Perl, and
Python) count from 0 because that‚Äôs simpler for computers to do.</p>
<div class="section level3">
<h3 id="conditional-subsetting">Conditional subsetting<a class="anchor" aria-label="anchor" href="#conditional-subsetting"></a>
</h3>
<p>Another common way of subsetting is by using a logical vector.
<code>TRUE</code> will select the element with the same index, while
<code>FALSE</code> will not:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">hh_members</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  3 10  6</code></pre>
</div>
<p>Typically, these logical vectors are not typed by hand, but are the
output of other functions or logical tests. For instance, if you wanted
to select only the values above 5:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span> <span class="op">&gt;</span> <span class="fl">5</span>    <span class="co"># will return logicals with TRUE for the indices that meet the condition</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE  TRUE  TRUE  TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## so we can use this to select only the values above 5</span></span>
<span><span class="va">hh_members</span><span class="op">[</span><span class="va">hh_members</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  7 10  6</code></pre>
</div>
<p>You can combine multiple tests using <code>&amp;</code> (both
conditions are true, AND) or <code>|</code> (at least one of the
conditions is true, OR):</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span><span class="op">[</span><span class="va">hh_members</span> <span class="op">&lt;</span> <span class="fl">4</span> <span class="op">|</span> <span class="va">hh_members</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  3 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hh_members</span><span class="op">[</span><span class="va">hh_members</span> <span class="op">&gt;=</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">hh_members</span> <span class="op">&lt;=</span> <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7 6</code></pre>
</div>
<p>Here, <code>&lt;</code> stands for ‚Äúless than‚Äù, <code>&gt;</code> for
‚Äúgreater than‚Äù, <code>&gt;=</code> for ‚Äúgreater than or equal to‚Äù, and
<code>==</code> for ‚Äúequal to‚Äù. The double equal sign <code>==</code> is
a test for numerical equality between the left and right hand sides, and
should not be confused with the single <code>=</code> sign, which
performs variable assignment (similar to <code>&lt;-</code>).</p>
<p>A common task is to search for certain strings in a vector. One could
use the ‚Äúor‚Äù operator <code>|</code> to test for equality to multiple
values, but this can quickly become tedious.</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span>, <span class="st">"radio"</span>, <span class="st">"television"</span>, <span class="st">"mobile_phone"</span><span class="op">)</span></span>
<span><span class="va">possessions</span><span class="op">[</span><span class="va">possessions</span> <span class="op">==</span> <span class="st">"car"</span> <span class="op">|</span> <span class="va">possessions</span> <span class="op">==</span> <span class="st">"bicycle"</span><span class="op">]</span> <span class="co"># returns both car and bicycle</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "car"     "bicycle"</code></pre>
</div>
<p>The function <code>%in%</code> allows you to test if any of the
elements of a search vector (on the left hand side) are found in the
target vector (on the right hand side):</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
</div>
<p>Note that the output is the same length as the search vector on the
left hand side, because <code>%in%</code> checks whether each element of
the search vector is found somewhere in the target vector. Thus, you can
use <code>%in%</code> to select the elements in the search vector that
appear in your target vector:</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span>, <span class="st">"motorcycle"</span>, <span class="st">"truck"</span>, <span class="st">"boat"</span>, <span class="st">"bus"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possessions</span><span class="op">[</span><span class="va">possessions</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"bicycle"</span>, <span class="st">"motorcycle"</span>, <span class="st">"truck"</span>, <span class="st">"boat"</span>, <span class="st">"bus"</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "car"     "bicycle"</code></pre>
</div>
</div>
</section><section id="missing-data"><h2 class="section-heading">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<hr class="half-width">
<p>As R was designed to analyze datasets, it includes the concept of
missing data (which is uncommon in other programming languages). Missing
data are represented in vectors as <code>NA</code>.</p>
<p>When doing operations on numbers, most functions will return
<code>NA</code> if the data you are working with include missing values.
This feature makes it harder to overlook the cases where you are dealing
with missing data. You can add the argument <code>na.rm=TRUE</code> to
calculate the result while ignoring the missing values.</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rooms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">max</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">rooms</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.75</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">max</span><span class="op">(</span><span class="va">rooms</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>If your data include missing values, you may want to become familiar
with the functions <code>is.na()</code>, <code>na.omit()</code>, and
<code>complete.cases()</code>. See below for examples.</p>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract those elements which are not missing values.</span></span>
<span><span class="va">rooms</span><span class="op">[</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 1 7</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Count the number of missing values.</span></span>
<span><span class="fu">sum</span><span class="op">(</span><span class="fu">is.na</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Returns the object with incomplete cases removed. The returned object is an atomic vector of type `"numeric"` (or `"double"`).</span></span>
<span><span class="fu">na.omit</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 1 7
attr(,"na.action")
[1] 4
attr(,"class")
[1] "omit"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extract those elements which are complete cases. The returned object is an atomic vector of type `"numeric"` (or `"double"`).</span></span>
<span><span class="va">rooms</span><span class="op">[</span><span class="fu">complete.cases</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 1 7</code></pre>
</div>
<p>Recall that you can use the <code>typeof()</code> function to find
the type of your atomic vector.</p>
<blockquote>
<h2 id="exercise-4">Exercise</h2>
<ol style="list-style-type: decimal">
<li>
<p>Using this vector of rooms, create a new vector with the NAs
removed.</p>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rooms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
</li>
<li><p>Use the function <code>median()</code> to calculate the median of
the <code>rooms</code> vector.</p></li>
<li><p>Use R to figure out how many households in the set use more than
2 rooms for sleeping.</p></li>
</ol>
<blockquote>
<h2 id="solution-5">Solution</h2>
<div class="codewrapper sourceCode" id="cb95">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rooms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">rooms_no_na</span> <span class="op">&lt;-</span> <span class="va">rooms</span><span class="op">[</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">rooms_no_na</span> <span class="op">&lt;-</span> <span class="fu">na.omit</span><span class="op">(</span><span class="va">rooms</span><span class="op">)</span></span>
<span><span class="co"># 2.</span></span>
<span><span class="fu">median</span><span class="op">(</span><span class="va">rooms</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb97">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3.</span></span>
<span><span class="va">rooms_above_2</span> <span class="op">&lt;-</span> <span class="va">rooms_no_na</span><span class="op">[</span><span class="va">rooms_no_na</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">rooms_above_2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>Now that we have learned how to write scripts, and the basics of R‚Äôs
data structures, we are ready to start working a real dataset, and learn
about data frames.</p>
<p>{% include links.md %}</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-02-starting-with-data"><p>Content from <a href="02-starting-with-data.html">Starting with Data</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/02-starting-with-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="what-are-data-frames-and-tibbles"><h2 class="section-heading">What are data frames and tibbles?<a class="anchor" aria-label="anchor" href="#what-are-data-frames-and-tibbles"></a>
</h2>
<hr class="half-width">
<p>Data frames are the <em>de facto</em> data structure for tabular data
in <code>R</code>, and what we use for data processing, statistics, and
plotting.</p>
<p>A data frame is the representation of data in the format of a table
where the columns are vectors that all have the same length. Data frames
are analogous to the more familiar spreadsheet in programs such as
Excel, with one key difference. Because columns are vectors, each column
must contain a single type of data (e.g., characters, integers,
factors). For example, here is a figure depicting a data frame
comprising a numeric, a character, and a logical vector.</p>
<figure><img src="../fig/data-frame.svg" alt="" class="figure mx-auto d-block"><figcaption>A 3 by 3 data frame with columns showing numeric,
character and logical values.</figcaption></figure><p>Data frames can be created by hand, but most commonly they are
generated by the functions <code>read_csv()</code> or
<code>read_table()</code>; in other words, when importing spreadsheets
from your hard drive (or the web). We will now demonstrate how to import
tabular data using <code>read_csv()</code>.</p>
</section><section id="presentation-of-the-safi-data"><h2 class="section-heading">Presentation of the SAFI Data<a class="anchor" aria-label="anchor" href="#presentation-of-the-safi-data"></a>
</h2>
<hr class="half-width">
<p>SAFI (Studying African Farmer-Led Irrigation) is a study looking at
farming and irrigation methods in Tanzania and Mozambique. The survey
data was collected through interviews conducted between November 2016
and June 2017. For this lesson, we will be using a subset of the
available data. For information about the full dataset, see the <a href="http://www.datacarpentry.org/socialsci-workshop/data/" class="external-link">dataset
description</a>.</p>
<p>We will be using a subset of the cleaned version of the dataset that
was produced through cleaning in OpenRefine
(<code>data/SAFI_clean.csv</code>). Each row holds information for a
single interview respondent, and the columns represent:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>column_name</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>key_id</td>
<td>Added to provide a unique Id for each observation. (The InstanceID
field does this as well but it is not as convenient to use)</td>
</tr>
<tr class="even">
<td>village</td>
<td>Village name</td>
</tr>
<tr class="odd">
<td>interview_date</td>
<td>Date of interview</td>
</tr>
<tr class="even">
<td>no_membrs</td>
<td>How many members in the household?</td>
</tr>
<tr class="odd">
<td>respondent_wall_type</td>
<td>What type of walls does their house have (from list)</td>
</tr>
<tr class="even">
<td>no_meals</td>
<td>How many meals do people in your household normally eat in a
day?</td>
</tr>
</tbody>
</table></section><section id="importing-data"><h2 class="section-heading">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h2>
<hr class="half-width">
<p>You are going load the data in R‚Äôs memory using the function
<code>read_csv()</code> from the <strong><code>readr</code></strong>
package, which is part of the <strong><code>tidyverse</code></strong>;
learn more about the <strong><code>tidyverse</code></strong> collection
of packages <a href="https://www.tidyverse.org/" class="external-link">here</a>.
<strong><code>readr</code></strong> gets installed as part as the
<strong><code>tidyverse</code></strong> installation. When you load the
<strong><code>tidyverse</code></strong>
(<code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>), the core packages (the packages used
in most data analyses) get loaded, including
<strong><code>readr</code></strong>.</p>
<p>Before we can use the <code>read_csv()</code> we need to load the
tidyverse package.</p>
<p>Also, if you recall, the missing data is encoded as ‚ÄúNULL‚Äù in the
dataset. We‚Äôll tell it to the function, so R will automatically convert
all the ‚ÄúNULL‚Äù entries in the dataset into <code>NA</code>.</p>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: '../data/SAFI_clean.csv' does not exist in current working directory ('/home/runner/work/R-intro/R-intro/site/built').</code></pre>
</div>
<p>The specific path we are using here is dependent on the specific
setup. If you have followed the recommendations for structuring your
project-folder, it should be this command:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interviews</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/SAFI_clean.csv"</span>, na <span class="op">=</span> <span class="st">"NULL"</span><span class="op">)</span></span></code></pre>
</div>
<p>If you were to type in the code above, it is likely that the
<code>read.csv()</code> function would appear in the automatically
populated list of functions. This function is different from the
<code>read_csv()</code> function, as it is included in the ‚Äúbase‚Äù
packages that come pre-installed with R. Overall,
<code>read.csv()</code> behaves similar to <code>read_csv()</code>, with
a few notable differences. First, <code>read.csv()</code> coerces column
names with spaces and/or special characters to different names
(e.g.¬†<code>interview date</code> becomes <code>interview.date</code>).
Second, <code>read.csv()</code> stores data as a
<code>data.frame</code>, where <code>read_csv()</code> stores data as a
<code>tibble</code>. We prefer tibbles because they have nice printing
properties among other desirable qualities. Read more about tibbles <a href="https://tibble.tidyverse.org/" class="external-link">here</a>.</p>
<p>The second statement in the code above creates a data frame but
doesn‚Äôt output any data because, as you might recall, assignments
(<code>&lt;-</code>) don‚Äôt display anything. (Note, however, that
<code>read_csv</code> may show informational text about the data frame
that is created.) If we want to check that our data has been loaded, we
can see the contents of the data frame by typing its name:
<code>interviews</code> in the console.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Try also</span></span>
<span><span class="co">## view(interviews)</span></span>
<span><span class="co">## head(interviews)</span></span></code></pre>
</div>
<blockquote>
<h2 id="note">Note</h2>
<p><code>read_csv()</code> assumes that fields are delimited by commas.
However, in several countries, the comma is used as a decimal separator
and the semicolon (;) is used as a field delimiter. If you want to read
in this type of files in R, you can use the <code>read_csv2</code>
function. It behaves exactly like <code>read_csv</code> but uses
different parameters for the decimal and the field separators. If you
are working with another format, they can be both specified by the user.
Check out the help for <code>read_csv()</code> by typing
<code>?read_csv</code> to learn more. There is also the
<code>read_tsv()</code> for tab-separated data files, and
<code>read_delim()</code> allows you to specify more details about the
structure of your file. {: .callout}</p>
</blockquote>
<p>Note that <code>read_csv()</code> actually loads the data as a
tibble. A tibble is an extension of <code>R</code> data frames used by
the <strong><code>tidyverse</code></strong>. When the data is read using
<code>read_csv()</code>, it is stored in an object of class
<code>tbl_df</code>, <code>tbl</code>, and <code>data.frame</code>. You
can see the class of an object with</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>As a <code>tibble</code>, the type of data included in each column is
listed in an abbreviated fashion below the column names. For instance,
here <code>key_ID</code> is a column of floating point numbers
(abbreviated <code>&lt;dbl&gt;</code> for the word ‚Äòdouble‚Äô),
<code>village</code> is a column of characters
(<code>&lt;chr&gt;</code>) and the <code>interview_date</code> is a
column in the ‚Äúdate and time‚Äù format (<code>&lt;dttm&gt;</code>).</p>
</section><section id="inspecting-data-frames"><h2 class="section-heading">Inspecting data frames<a class="anchor" aria-label="anchor" href="#inspecting-data-frames"></a>
</h2>
<hr class="half-width">
<p>When calling a <code>tbl_df</code> object (like
<code>interviews</code> here), there is already a lot of information
about our data frame being displayed such as the number of rows, the
number of columns, the names of the columns, and as we just saw the
class of data stored in each column. However, there are functions to
extract this information from data frames. Here is a non-exhaustive list
of some of these functions. Let‚Äôs try them out!</p>
<p>Size:</p>
<ul>
<li>
<code>dim(interviews)</code> - returns a vector with the number of
rows as the first element, and the number of columns as the second
element (the <strong>dim</strong>ensions of the object)</li>
<li>
<code>nrow(interviews)</code> - returns the number of rows</li>
<li>
<code>ncol(interviews)</code> - returns the number of columns</li>
</ul>
<p>Content:</p>
<ul>
<li>
<code>head(interviews)</code> - shows the first 6 rows</li>
<li>
<code>tail(interviews)</code> - shows the last 6 rows</li>
</ul>
<p>Names:</p>
<ul>
<li>
<code>names(interviews)</code> - returns the column names (synonym
of <code>colnames()</code> for <code>data.frame</code> objects)</li>
</ul>
<p>Summary:</p>
<ul>
<li>
<code>str(interviews)</code> - structure of the object and
information about the class, length and content of each column</li>
<li>
<code>summary(interviews)</code> - summary statistics for each
column</li>
<li>
<code>glimpse(interviews)</code> - returns the number of columns and
rows of the tibble, the names and class of each column, and previews as
many values will fit on the screen. Unlike the other inspecting
functions listed above, <code>glimpse()</code> is not a ‚Äúbase R‚Äù
function so you need to have the <code>dplyr</code> or
<code>tibble</code> packages loaded to be able to execute it.</li>
</ul>
<p>Note: most of these functions are ‚Äúgeneric.‚Äù They can be used on
other types of objects besides data frames or tibbles.</p>
</section><section id="indexing-and-subsetting-data-frames"><h2 class="section-heading">Indexing and subsetting data frames<a class="anchor" aria-label="anchor" href="#indexing-and-subsetting-data-frames"></a>
</h2>
<hr class="half-width">
<p>Our <code>interviews</code> data frame has rows and columns (it has 2
dimensions). In practice, we may not need the entire data frame; for
instance, we may only be interested in a subset of the observations (the
rows) or a particular set of variables (the columns). If we want to
extract some specific data from it, we need to specify the ‚Äúcoordinates‚Äù
we want from it. Row numbers come first, followed by column numbers.</p>
<blockquote>
<h2 id="tip">Tip</h2>
<p>Indexing a <code>tibble</code> with <code>[</code> or <code>[[</code>
or <code>$</code> always results in a <code>tibble</code>. However, note
this is not true in general for data frames, so be careful! Different
ways of specifying these coordinates can lead to results with different
classes. This is covered in the Software Carpentry lesson <a href="https://swcarpentry.github.io/r-novice-gapminder/" class="external-link">R for
Reproducible Scientific Analysis</a>. {: .callout}</p>
</blockquote>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first element in the first column of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first element in the 6th column of the tibble </span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first column of the tibble (as a vector)</span></span>
<span><span class="va">interviews</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first column of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## first three elements in the 7th column of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## the 3rd row of the tibble</span></span>
<span><span class="va">interviews</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## equivalent to head_interviews &lt;- head(interviews)</span></span>
<span><span class="va">head_interviews</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p><code>:</code> is a special function that creates numeric vectors of
integers in increasing or decreasing order, test <code>1:10</code> and
<code>10:1</code> for instance.</p>
<p>You can also exclude certain indices of a data frame using the
‚Äú<code>-</code>‚Äù sign:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>          <span class="co"># The whole tibble, except the first column</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">[</span><span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">131</span><span class="op">)</span>, <span class="op">]</span>   <span class="co"># Equivalent to head(interviews)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p><code>tibble</code>s can be subset by calling indices (as shown
previously), but also by calling their column names directly:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span><span class="op">[</span><span class="st">"village"</span><span class="op">]</span>       <span class="co"># Result is a tibble</span></span>
<span></span>
<span><span class="va">interviews</span><span class="op">[</span>, <span class="st">"village"</span><span class="op">]</span>     <span class="co"># Result is a tibble</span></span>
<span></span>
<span><span class="va">interviews</span><span class="op">[[</span><span class="st">"village"</span><span class="op">]</span><span class="op">]</span>     <span class="co"># Result is a vector</span></span>
<span></span>
<span><span class="va">interviews</span><span class="op">$</span><span class="va">village</span>          <span class="co"># Result is a vector</span></span></code></pre>
</div>
<p>In RStudio, you can use the autocompletion feature to get the full
and correct names of the columns.</p>
<blockquote>
<h2 id="exercise">Exercise</h2>
<ol style="list-style-type: decimal">
<li><p>Create a tibble (<code>interviews_100</code>) containing only the
data in row 100 of the <code>interviews</code> dataset.</p></li>
<li>
<p>Notice how <code>nrow()</code> gave you the number of rows in the
tibble?</p>
<ul>
<li>Use that number to pull out just that last row in the tibble.</li>
<li>Compare that with what you see as the last row using
<code>tail()</code> to make sure it‚Äôs meeting expectations.</li>
<li>Pull out that last row using <code>nrow()</code> instead of the row
number.</li>
<li>Create a new tibble (<code>interviews_last</code>) from that last
row.</li>
</ul>
</li>
<li><p>Using the number of rows in the interviews dataset that you found
in question 2, extract the row that is in the middle of the dataset.
Store the content of this middle row in an object named
<code>interviews_middle</code>. (hint: This dataset has an odd number of
rows, so finding the middle is a bit trickier than dividing n_rows by 2.
Use the median( ) function and what you‚Äôve learned about sequences in R
to extract the middle row!</p></li>
<li><p>Combine <code>nrow()</code> with the <code>-</code> notation
above to reproduce the behavior of <code>head(interviews)</code>,
keeping just the first through 6th rows of the interviews
dataset.</p></li>
</ol>
<blockquote>
<h2 id="solution">Solution</h2>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1.</span></span>
<span><span class="va">interviews_100</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="fl">100</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 2.</span></span>
<span><span class="co"># Saving `n_rows` to improve readability and reduce duplication</span></span>
<span><span class="va">n_rows</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_last</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="va">n_rows</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 3.</span></span>
<span><span class="va">interviews_middle</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="fu">median</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_rows</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 4.</span></span>
<span><span class="va">interviews_head</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="va">n_rows</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>{% include links.md %}</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-03-dplyr-tidyr"><p>Content from <a href="03-dplyr-tidyr.html">Data Wrangling with dplyr and tidyr</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/03-dplyr-tidyr.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I select specific rows and/or columns from a dataframe?</li>
<li>How can I combine multiple commands into a single command?</li>
<li>How can I create new columns or remove existing columns from a
dataframe?</li>
<li>How can I reformat a dataframe to meet my needs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the purpose of an R package and the
<strong><code>dplyr</code></strong> and
<strong><code>tidyr</code></strong> packages.</li>
<li>Select certain columns in a dataframe with the
<strong><code>dplyr</code></strong> function <code>select</code>.</li>
<li>Select certain rows in a dataframe according to filtering conditions
with the <strong><code>dplyr</code></strong> function
<code>filter</code>.</li>
<li>Link the output of one <strong><code>dplyr</code></strong> function
to the input of another function with the ‚Äòpipe‚Äô operator
<code>%&gt;%</code>.</li>
<li>Add new columns to a dataframe that are functions of existing
columns with <code>mutate</code>.</li>
<li>Use the split-apply-combine concept for data analysis.</li>
<li>Use <code>summarize</code>, <code>group_by</code>, and
<code>count</code> to split a dataframe into groups of observations,
apply a summary statistics for each group, and then combine the
results.</li>
<li>Describe the concept of a wide and a long table format and for which
purpose those formats are useful.</li>
<li>Describe the roles of variable names and their associated values
when a table is reshaped.</li>
<li>Reshape a dataframe from long to wide format and back with the
<code>pivot_wider</code> and <code>pivot_longer</code> commands from the
<strong><code>tidyr</code></strong> package.</li>
<li>Export a dataframe to a csv file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p><strong><code>dplyr</code></strong> is a package for making tabular
data wrangling easier by using a limited set of functions that can be
combined to extract and summarize insights from your data. It pairs
nicely with <strong><code>tidyr</code></strong> which enables you to
swiftly convert between different data formats (long vs.¬†wide) for
plotting and analysis.</p>
<p>Similarly to <strong><code>readr</code></strong>,
<strong><code>dplyr</code></strong> and
<strong><code>tidyr</code></strong> are also part of the tidyverse.
These packages were loaded in R‚Äôs memory when we called
<code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code> earlier.</p>
<p>## Note husk dette er en callout!</p>
<p>The packages in the tidyverse, namely
<strong><code>dplyr</code></strong>, <strong><code>tidyr</code></strong>
and <strong><code>ggplot2</code></strong> accept both the British
(e.g.¬†<em>summarise</em>) and American (e.g.¬†<em>summarize</em>)
spelling variants of different function and option names. For this
lesson, we utilize the American spellings of different functions;
however, feel free to use the regional variant for where you are
teaching.</p>
<section id="what-is-an-r-package"><h2 class="section-heading">What is an R package?<a class="anchor" aria-label="anchor" href="#what-is-an-r-package"></a>
</h2>
<hr class="half-width">
<p>The package <strong><code>dplyr</code></strong> provides easy tools
for the most common data wrangling tasks. It is built to work directly
with dataframes, with many common tasks optimized by being written in a
compiled language (C++) (not all R packages are written in R!).</p>
<p>The package <strong><code>tidyr</code></strong> addresses the common
problem of wanting to reshape your data for plotting and use by
different R functions. Sometimes we want data sets where we have one row
per measurement. Sometimes we want a dataframe where each measurement
type has its own column, and rows are instead more aggregated groups.
Moving back and forth between these formats is nontrivial, and
<strong><code>tidyr</code></strong> gives you tools for this and more
sophisticated data wrangling.</p>
<p>But there are also packages available for a wide range of tasks
including building plots (<strong><code>ggplot2</code></strong>, which
we‚Äôll see later), downloading data from the NCBI database, or performing
statistical analysis on your data set. Many packages such as these are
housed on, and downloadable from, the <strong>C</strong>omprehensive
<strong>R</strong> <strong>A</strong>rchive <strong>N</strong>etwork
(CRAN) using <code>install.packages</code>. This function makes the
package accessible by your R installation with the command
<code>library()</code>, as you did with <code>tidyverse</code>
earlier.</p>
<p>To easily access the documentation for a package within R or RStudio,
use <code><a href="https://rdrr.io/pkg/package_name/man" class="external-link">help(package = "package_name")</a></code>.</p>
<p>To learn more about <strong><code>dplyr</code></strong> and
<strong><code>tidyr</code></strong> after the workshop, you may want to
check out this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf" class="external-link">handy
data transformation with <strong><code>dplyr</code></strong>
cheatsheet</a> and this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf" class="external-link">one
about <strong><code>tidyr</code></strong></a>.</p>
</section><section id="learning-dplyr-and-tidyr"><h2 class="section-heading">Learning <strong><code>dplyr</code></strong> and
<strong><code>tidyr</code></strong><a class="anchor" aria-label="anchor" href="#learning-dplyr-and-tidyr"></a>
</h2>
<hr class="half-width">
<p>We are working with the same dataset as earlier. Refer to the
previous lesson to download the data, if you do not have it loaded.</p>
<p>We‚Äôre going to learn some of the most common
<strong><code>dplyr</code></strong> functions:</p>
<ul>
<li>
<code>select()</code>: subset columns</li>
<li>
<code>filter()</code>: subset rows on conditions</li>
<li>
<code>mutate()</code>: create new columns by using information from
other columns</li>
<li>
<code>group_by()</code> and <code>summarize()</code>: create summary
statistics on grouped data</li>
<li>
<code>arrange()</code>: sort results</li>
<li>
<code>count()</code>: count discrete values</li>
</ul></section><section id="selecting-columns-and-filtering-rows"><h2 class="section-heading">Selecting columns and filtering rows<a class="anchor" aria-label="anchor" href="#selecting-columns-and-filtering-rows"></a>
</h2>
<hr class="half-width">
<p>To select columns of a dataframe, use <code>select()</code>. The
first argument to this function is the dataframe
(<code>interviews</code>), and the subsequent arguments are the columns
to keep, separated by commas. Alternatively, if you are selecting
columns adjacent to each other, you can use a <code>:</code> to select a
range of columns, read as ‚Äúselect columns from ___ to ___.‚Äù</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to select columns throughout the dataframe</span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span>, <span class="va">no_membrs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to select a series of connected columns</span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>To choose rows based on specific criteria, we can use the
<code>filter()</code> function. The argument after the dataframe is the
condition we want our final dataframe to adhere to (e.g.¬†village name is
Chirodzo):</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations where village name is "Chirodzo" </span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>We can also specify multiple conditions within the
<code>filter()</code> function. We can combine conditions using either
‚Äúand‚Äù or ‚Äúor‚Äù statements. In an ‚Äúand‚Äù statement, an observation (row)
must meet <strong>every</strong> criteria to be included in the
resulting dataframe. To form ‚Äúand‚Äù statements within dplyr, we can pass
our desired conditions as arguments in the <code>filter()</code>
function, separated by commas:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations with "and" operator (comma)</span></span>
<span><span class="co"># output dataframe satisfies ALL specified conditions</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span>, </span>
<span>                   <span class="va">no_membrs</span> <span class="op">&gt;</span> <span class="fl">4</span>, </span>
<span>                   <span class="va">no_meals</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>We can also form ‚Äúand‚Äù statements with the <code>&amp;</code>
operator instead of commas:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations with "&amp;" logical operator</span></span>
<span><span class="co"># output dataframe satisfies ALL specified conditions</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">no_membrs</span> <span class="op">&gt;</span> <span class="fl">4</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">no_meals</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>In an ‚Äúor‚Äù statement, observations must meet <em>at least one</em> of
the specified conditions. To form ‚Äúor‚Äù statements we use the logical
operator for ‚Äúor,‚Äù which is the vertical bar (|):</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filters observations with "|" logical operator</span></span>
<span><span class="co"># output dataframe satisfies AT LEAST ONE of the specified conditions</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span> <span class="op">|</span> <span class="va">village</span> <span class="op">==</span> <span class="st">"Ruaca"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
</section><section id="pipes"><h2 class="section-heading">Pipes<a class="anchor" aria-label="anchor" href="#pipes"></a>
</h2>
<hr class="half-width">
<p>What if you want to select and filter at the same time? There are
three ways to do this: use intermediate steps, nested functions, or
pipes.</p>
<p>With intermediate steps, you create a temporary dataframe and use
that as input to the next function, like this:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews2</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_ch</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">interviews2</span>, <span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews2' not found</code></pre>
</div>
<p>This is readable, but can clutter up your workspace with lots of
objects that you have to name individually. With multiple steps, that
can be hard to keep track of.</p>
<p>You can also nest functions (i.e.¬†one function inside of another),
like this:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_ch</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="fu">filter</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span>,</span>
<span>                         <span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>This is handy, but can be difficult to read if too many functions are
nested, as R evaluates the expression from the inside out (in this case,
filtering, then selecting).</p>
<p>The last option, <em>pipes</em>, are a recent addition to R. Pipes
let you take the output of one function and send it directly to the
next, which is useful when you need to do many things to the same
dataset. Pipes in R look like <code>%&gt;%</code> and are made available
via the <strong><code>magrittr</code></strong> package, installed
automatically with <strong><code>dplyr</code></strong>. If you use
RStudio, you can type the pipe with:<br>
- <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a PC or
<kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a Mac.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>In the above code, we use the pipe to send the
<code>interviews</code> dataset first through <code>filter()</code> to
keep rows where <code>village</code> is ‚ÄúChirodzo‚Äù, then through
<code>select()</code> to keep only the <code>no_membrs</code> and
<code>years_liv</code> columns. Since <code>%&gt;%</code> takes the
object on its left and passes it as the first argument to the function
on its right, we don‚Äôt need to explicitly include the dataframe as an
argument to the <code>filter()</code> and <code>select()</code>
functions any more.</p>
<p>Some may find it helpful to read the pipe like the word ‚Äúthen‚Äù. For
instance, in the above example, we take the dataframe
<code>interviews</code>, <em>then</em> we <code>filter</code> for rows
with <code>village == "Chirodzo"</code>, <em>then</em> we
<code>select</code> columns <code>no_membrs</code> and
<code>years_liv</code>. The <strong><code>dplyr</code></strong>
functions by themselves are somewhat simple, but by combining them into
linear workflows with the pipe, we can accomplish more complex data
wrangling operations.</p>
<p>If we want to create a new object with this smaller version of the
data, we can assign it a new name:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_ch</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">village</span> <span class="op">==</span> <span class="st">"Chirodzo"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">village</span><span class="op">:</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_ch</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_ch' not found</code></pre>
</div>
<p>Note that the final dataframe (<code>interviews_ch</code>) is the
leftmost part of this expression.</p>
<div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Using pipes, subset the <code>interviews</code> data to include
interviews where respondents were members of an irrigation association
(<code>memb_assoc</code>) and retain only the columns
<code>affect_conflicts</code>, <code>liv_count</code>, and
<code>no_meals</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">filter</span><span class="op">(</span><span class="va">memb_assoc</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">select</span><span class="op">(</span><span class="va">affect_conflicts</span>, <span class="va">liv_count</span>, <span class="va">no_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="mutate">Mutate<a class="anchor" aria-label="anchor" href="#mutate"></a>
</h3>
<p>Frequently you‚Äôll want to create new columns based on the values in
existing columns, for example to do unit conversions, or to find the
ratio of values in two columns. For this we‚Äôll use
<code>mutate()</code>.</p>
<p>We might be interested in the number of meals served in a given
household (i.e.¬†number of people times the number of meals served):</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>people_per_room <span class="op">=</span> <span class="va">no_membrs</span> <span class="op">*</span> <span class="va">no_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Create a new dataframe from the <code>interviews</code> data that
meets the following criteria: contains only the <code>village</code>
column and a new column called <code>total_meals</code> containing a
value that is equal to the total number of meals served in the household
per day on average (<code>no_membrs</code> times <code>no_meals</code>).
Only the rows where <code>total_meals</code> is greater than 20 should
be shown in the final dataframe.</p>
<p><strong>Hint</strong>: think about how the commands should be ordered
to produce this data frame!</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_total_meals</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>total_meals <span class="op">=</span> <span class="va">no_membrs</span> <span class="op">*</span> <span class="va">no_meals</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">total_meals</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">select</span><span class="op">(</span><span class="va">village</span>, <span class="va">total_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="split-apply-combine-data-analysis-and-the-summarize-function">Split-apply-combine data analysis and the summarize() function<a class="anchor" aria-label="anchor" href="#split-apply-combine-data-analysis-and-the-summarize-function"></a>
</h3>
<p>Many data analysis tasks can be approached using the
<em>split-apply-combine</em> paradigm: split the data into groups, apply
some analysis to each group, and then combine the results.
<strong><code>dplyr</code></strong> makes this very easy through the use
of the <code>group_by()</code> function.</p>
<div class="section level4">
<h4 id="the-summarize-function">The <code>summarize()</code> function<a class="anchor" aria-label="anchor" href="#the-summarize-function"></a>
</h4>
<p><code>group_by()</code> is often used together with
<code>summarize()</code>, which collapses each group into a single-row
summary of that group. <code>group_by()</code> takes as arguments the
column names that contain the <strong>categorical</strong> variables for
which you want to calculate the summary statistics. So to compute the
average household size by village:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>You may also have noticed that the output from these calls doesn‚Äôt
run off the screen anymore. It‚Äôs one of the advantages of
<code>tbl_df</code> over dataframe.</p>
<p>You can also group by multiple columns:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>Note that the output is a grouped tibble. To obtain an ungrouped
tibble, use the <code>ungroup</code> function:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>Once the data are grouped, you can also summarize multiple variables
at the same time (and not necessarily on the same variable). For
instance, we could add a column indicating the minimum household size
for each village for each group (type of wall):</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>              min_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>It is sometimes useful to rearrange the result of a query to inspect
the values. For instance, we can sort on <code>min_membrs</code> to put
the group with the smallest household first:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>              min_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">min_membrs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>To sort in descending order, we need to add the <code>desc()</code>
function. If we want to sort the results by decreasing order of minimum
household size:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span>mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>              min_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">min_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="counting">Counting<a class="anchor" aria-label="anchor" href="#counting"></a>
</h4>
<p>When working with data, we often want to know the number of
observations found for each factor or combination of factors. For this
task, <strong><code>dplyr</code></strong> provides <code>count()</code>.
For example, if we wanted to count the number of rows of data for each
village, we would do:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">village</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>For convenience, <code>count()</code> provides the <code>sort</code>
argument to get results in decreasing order:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">village</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>## Exercise</p>
<p>How many households in the survey have an average of two meals per
day? Three meals per day? Are there any other numbers of meals
represented?</p>
</div>
</div>
</section><section id="solution-2"><h2 class="section-heading">Solution<a class="anchor" aria-label="anchor" href="#solution-2"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">no_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>Use <code>group_by()</code> and <code>summarize()</code> to find the
mean, min, and max number of household members for each village. Also
add the number of observations (hint: see <code>?n</code>).</p>
</section><section id="solution-3"><h2 class="section-heading">Solution<a class="anchor" aria-label="anchor" href="#solution-3"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">summarize</span><span class="op">(</span></span>
<span>       mean_no_membrs <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>       min_no_membrs <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>       max_no_membrs <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span>,</span>
<span>       n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<p>What was the largest household interviewed in each month?</p>
</section><section id="solution-4"><h2 class="section-heading">Solution<a class="anchor" aria-label="anchor" href="#solution-4"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># if not already included, add month, year, and day columns</span></span>
<span> <span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span> <span class="co"># load lubridate if not already loaded</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">mutate</span><span class="op">(</span>month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">interview_date</span><span class="op">)</span>,</span>
<span>            day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">interview_date</span><span class="op">)</span>,</span>
<span>            year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">interview_date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">summarize</span><span class="op">(</span>max_no_membrs <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
</section><section id="exporting-data"><h2 class="section-heading">Exporting data<a class="anchor" aria-label="anchor" href="#exporting-data"></a>
</h2>
<hr class="half-width">
<p>Now that you have learned how to use
<strong><code>dplyr</code></strong> to extract information from or
summarize your raw data, you may want to export these new data sets to
share them with your collaborators or for archival.</p>
<p>Similar to the <code>read_csv()</code> function used for reading CSV
files into R, there is a <code>write_csv()</code> function that
generates CSV files from dataframes.</p>
<p>Before using <code>write_csv()</code>, we are going to create a new
folder, <code>data_output</code>, in our working directory that will
store this generated dataset. We don‚Äôt want to write generated datasets
in the same directory as our raw data. It‚Äôs good practice to keep them
separate. The <code>data</code> folder should only contain the raw,
unaltered data, and should be left alone to make sure we don‚Äôt delete or
modify it. In contrast, our script will generate the contents of the
<code>data_output</code> directory, so even if the files it contains are
deleted, we can always re-generate them.</p>
<p>Now we can save this dataframe to our <code>data_output</code>
directory.</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">interviews</span>, file <span class="op">=</span> <span class="st">"data_output/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews' not found</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use the <code>dplyr</code> package to manipulate dataframes.</li>
<li>Use <code>select()</code> to choose variables from a dataframe.</li>
<li>Use <code>filter()</code> to choose data based on values.</li>
<li>Use <code>group_by()</code> and <code>summarize()</code> to work
with subsets of data.</li>
<li>Use <code>mutate()</code> to create new variables.</li>
<li>Use the <code>tidyr</code> package to change the layout of
dataframes.</li>
<li>Use <code>pivot_wider()</code> to go from long to wide format.</li>
<li>Use <code>pivot_longer()</code> to go from wide to long format.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-04-functions-plots"><p>Content from <a href="04-functions-plots.html">A couple of plots. And making our own functions</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/04-functions-plots.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 115 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="questions:">
<ul>
<li>‚ÄúHow do I create scatterplots, boxplots, and barplots?‚Äù</li>
<li>‚ÄúHow can I define my own functions?‚Äù</li>
</ul>
</div>
<div class="objectives:">
<ul>
<li>‚ÄúProduce scatter plots and boxplots using Base R.‚Äù</li>
<li>‚ÄúWrite your own function‚Äù</li>
<li>‚ÄúWrite loops to repeat calculations‚Äù</li>
<li>‚ÄúUse logical tests in loops‚Äù</li>
</ul>
</div>
<p>We start by loading the <strong><code>tidyverse</code></strong>
package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>If not still in the workspace, load the data we saved in the previous
lesson.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"../data_output/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: '../data_output/interviews_plotting.csv' does not exist in current working directory ('/home/runner/work/R-intro/R-intro/site/built').</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"/data_output/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
<section id="scatterplots"><h2 class="section-heading">Scatterplots<a class="anchor" aria-label="anchor" href="#scatterplots"></a>
</h2>
<hr class="half-width">
<p>Scatterplots visualizes the relation between two variables in the
dataset, by plotting individual observations in a two-dimensional graph,
with the position in the x,y-plane defined by the values of the two
variables.</p>
<p>The default plot function in Base R takes two vectors, one containing
the values of the x-axis and one containing the values for the y-axis.
Here we use the $-notation:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_membrs</span>, <span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_meals</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>Scatterplots are useful for showing that sort for relationships in
the data. Here it does not appear that the correlation exists; there is
no clear trend.</p>
<p>We might want to adjust the labels on the axes, and add a main
title:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_membrs</span>, <span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_meals</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Relation between number of members of households, and number of meals served"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Years lived"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Items owned"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
</section><section id="boxplots"><h2 class="section-heading">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h2>
<hr class="half-width">
<p>We can use boxplots to visualize the distribution of number of
household members for each wall type:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">boxplot</span><span class="op">(</span><span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_membrs</span><span class="op">~</span><span class="va">interviews_plotting</span><span class="op">$</span><span class="va">respondent_wall_type</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(predvars, data, env): object 'interviews_plotting' not found</code></pre>
</div>
<p>Two new things happens here. First, we are using a new way of telling
the plot function what relationship we want to visualise. The function
notation y~x, tells the boxplot function that we want to visualise y as
a function of x. In this case we want to visualise the number of people,
as af function of the wall type. Secondly, we use a boxplot. A boxplots
shows the distribution of the values on the y-axis. The median value is
indicated by the solid bar. The box encapsulates 50% of the
observations. Its upper and lower borders represents the interquartile
range (IQR). The whiskers on the plot - here only the upper whiskers are
shown due to the nature of the data, represents the range of the data.
The distance from the upper part of the box, to the whisker is 1.5 times
the interquartile range. The dots that we see for muddaub and sunbricks
are outliers. Observations that lies so far from the rest of the
observations, that we consider them as outliers.</p>
<p>Depending on the data, and the nature of the analyses we are going to
do, outliers are either very interesting, or something that we can
ignore.</p>
</section><section id="histograms"><h2 class="section-heading">Histograms<a class="anchor" aria-label="anchor" href="#histograms"></a>
</h2>
<hr class="half-width">
<p>Another useful plottype are histograms.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">interviews_plotting</span><span class="op">$</span><span class="va">no_membrs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>Histograms counts the number of observations in our data, that lies
between two values. Here the ‚Äúbreaks‚Äù between the values on the x-axis
corresponds nicely to the number of people, but they do not have to.</p>
</section><section id="writing-our-own-functions"><h2 class="section-heading">Writing our own functions<a class="anchor" aria-label="anchor" href="#writing-our-own-functions"></a>
</h2>
<hr class="half-width">
<p>When calculating an average of several values, we do two things.
First we count how many values there are. Then we sum all the values,
and divides the sum by the number of values. Rather than writing R-code
for each of these three operations, we use the mean() function, where
other more experienced programmers have written the code.</p>
<p>We can write our own functions, where we collect several operations
into one function.</p>
<p>Functions in R are defined in this way:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">function_name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">temporary_result_1</span> <span class="op">&lt;-</span> <span class="fu">some_function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">temporary_result_2</span> <span class="op">&lt;-</span> <span class="fu">some_other_function</span><span class="op">(</span><span class="va">temporary_result_1</span><span class="op">)</span></span>
<span>  <span class="fu">yet_another_function</span><span class="op">(</span><span class="va">temporary_result_2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>function_name defines the name of our function.</p>
<p>function(x) tells R that we are defining a function, that takes X as
input. We can then use that x as input to calculations or other
functions within our own function.</p>
<p>Between the curly braces {}, we define what we want our function to
do. We assign the result of some_function(x) to a temporary result, use
that as the input to a second function, and the result of that as the
input to a third function. The result of the last calculation we do,
will be returned as the output of our function.</p>
<blockquote>
<h2 id="exercise">Exercise</h2>
<p>Write a function that calculates the average value of a numeric
vector, takes the square root of that average, and returns the
result</p>
<blockquote>
<h2 id="solution">Solution</h2>
<p>One way to do this would be:</p>
<p>root_mean &lt;- function(x){ sqrt(mean(x, na.rm=T)) }</p>
<p>Another way could be:</p>
<p>root_mean &lt;- function(x){ temp &lt;- mean(x, na.rm =T) result
&lt;- sqrt(temp) result }</p>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</section><section id="logical-tests-in-functions"><h2 class="section-heading">Logical tests in functions<a class="anchor" aria-label="anchor" href="#logical-tests-in-functions"></a>
</h2>
<hr class="half-width">
<p>Some times we want to do something different to the data, depending
on the data. We can control the flow of the code using the if()
construction.</p>
<p>As an example: if(x&lt;10){ print(‚ÄúX is smaller than 10‚Äù) }else{
print(‚Äúx is larger than 10‚Äù) }</p>
<p>The if() function will run the code provided in the curly braces {},
if, and only if, the expression in the paranthesis is true. If x is 11,
x is not<br>
smaller than 10, and the first print function will not be executed.</p>
<p>The else-part is not requiered, but normally we will have to execute
some other code if the statement in the if-function is not true. In this
case if x is 11, the first print-function will not be executed, but the
second will.</p>
<p>We use logical tests to handle data differently, depending on some
characteristics of the data.</p>
</section><section id="loops"><h2 class="section-heading">loops<a class="anchor" aria-label="anchor" href="#loops"></a>
</h2>
<hr class="half-width">
<p>Loops are constructs we use to do the same operations on lots of
data.</p>
<div class="section level3">
<h3 id="for-loops">for loops<a class="anchor" aria-label="anchor" href="#for-loops"></a>
</h3>
<p>For loops are constructs used to apply one or more functions on a
series of data.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1
[1] 1.414214
[1] 1.732051
[1] 2
[1] 2.236068
[1] 2.44949
[1] 2.645751
[1] 2.828427
[1] 3
[1] 3.162278</code></pre>
</div>
<p>will take every value in the vector 1:10, the digits 1 to 10, one by
one, assign it to a temporary variable i and run the code we write in
the curly braces. Here the for-loop will take all numbers from 1 to 10,
calculate the squareroot of them. The result is assigned to another
temporary variable ‚Äútemp‚Äù and then temp is printed.</p>
<div class="section level4">
<h4 id="danger-will-robinson">Danger Will Robinson<a class="anchor" aria-label="anchor" href="#danger-will-robinson"></a>
</h4>
<p>As a general rule, R does not handle loops very efficiently. This is
a simple loop, operating on only 10 values, and we wont notice the
difference in speed.</p>
<p>But we can measure it.</p>
<p>The Sys.time() function will tell us what time our computer thinks it
is. If we run that just before, and just after our loop, we can
calculate how long it took to run.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">for_time</span> <span class="op">&lt;-</span> <span class="va">toc</span> <span class="op">-</span> <span class="va">tic</span></span></code></pre>
</div>
<p>A more efficient way to calculate the square root of the numbers from
1 to 10 would be use the fact that sqrt() is a vectorized function that
will calculate the square root of every element in a vector used as
input to it:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">sqrt</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">vect_time</span> <span class="op">&lt;-</span> <span class="va">toc</span> <span class="op">-</span> <span class="va">tic</span></span>
<span><span class="va">vect_time</span></span></code></pre>
</div>
<p>And we can then compare how much faster the latter vectorized
solution is.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">for_time</span><span class="op">)</span><span class="op">/</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">vect_time</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6.823786</code></pre>
</div>
<p>More than double as fast! To be fair most of the time is spent
outputting the results, but as a general rule utilizing the vectorized
nature of functions is faster than writing loops. But that is not always
a luxury we have.</p>
</div>
</div>
<div class="section level3">
<h3 id="while-loops">while loops<a class="anchor" aria-label="anchor" href="#while-loops"></a>
</h3>
<p>While loops are loops that execute the code - as long as some
criterium is satisfied.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">while</span><span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="fu">sqrt</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1
[1] 1.414214
[1] 1.732051
[1] 2
[1] 2.236068
[1] 2.44949
[1] 2.645751
[1] 2.828427
[1] 3
[1] 3.162278</code></pre>
</div>
<p>This loop structure does the exact same as the two previous examples.
Here we need to assign an initial value i, and then our while loop will
execute the code within the curly braces, as long as i is smaller than
or equal to 10. It is important to remember to increment the value of i
- otherwise i will always be 1, and therefore always smaller than 10.
And the loop will never stop.</p>
</div>
</section><section id="ggplot"><h2 class="section-heading">ggplot<a class="anchor" aria-label="anchor" href="#ggplot"></a>
</h2>
<hr class="half-width">
<p>The plotting functions in R produce nice clean plots without any
fancy details. That is generally a good thing, we want to maximize the
information per ink in our plots.</p>
<p>However, we are limited in the types of plots we can make, and
sometimes we just want a bit more color.</p>
<p>Enter ggplot2.</p>
<p>ggplot2 is a package designed to work well with the packages we have
already encountered. It produces plots in a structured way, and comes
with a lot of extensions, that enables us to plot almost anything.</p>
<p>The basic structure of ggplots are:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>ggplot takes some data. Typically we will provide the data using the
pipe: <code>%&gt;%</code></p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The <code>mapping</code> argument tells ggplot which variables in our
data should be mapped to the x- and y-axes in our plot.</p>
<p>That in itself will not produce much of a plot. We need to tell
ggplot which type of plot we want.</p>
<p>We do that by adding a <code>geom_</code> function. Here we have
added <code>geom_point</code> which produces a scatter-plot. Other
functions are more intuitively named. <code>geom_col</code> gives us a
column-plot, <code>geom_histogram</code> a histogram etc.</p>
<p>Let us try to make a histogram like we saw earlier:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>It looks different, and we get a warning about <code>binwidth</code>.
geom_histogram automatically chooses 30 bins for us, and that is
normally not the right number.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>‚ÄúBoxplots are useful for visualizing the distribution of a
continuous variable.‚Äù</li>
<li>‚ÄúBarplots are useful for visualizing categorical data.‚Äù</li>
<li>‚ÄúFunctions allows you to repeat the same set of operations again and
again.‚Äù</li>
<li>‚ÄúLoops allows you to apply the same function to lots of data.‚Äù</li>
<li>‚ÄúLogical tests allow you to apply different calculations on
different sets of data.‚Äù</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-05-whats-next"><p>Content from <a href="05-whats-next.html">What is the next step?</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/05-whats-next.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>‚ÄúWhat do I do now?‚Äù</li>
<li>‚ÄúWhat is the next step?‚Äù</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>‚ÄúPresent suggestions for further reading,‚Äù</li>
<li>‚ÄúTips on problems to work on to practice,‚Äù</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="great-sites"><h2 class="section-heading">Great sites<a class="anchor" aria-label="anchor" href="#great-sites"></a>
</h2>
<hr class="half-width">
<p><a href="https://www.edx.org/" class="external-link">edx</a></p>
<p><a href="https://www.datacamp.com/" class="external-link">datacamp</a></p>
<p><a href="https://cognitiveclass.ai/" class="external-link">cognitive class</a></p>
</section><section id="what-should-i-practice-on"><h2 class="section-heading">What should I practice on?<a class="anchor" aria-label="anchor" href="#what-should-i-practice-on"></a>
</h2>
<hr class="half-width">
<p><a href="https://www.kaggle.com/" class="external-link">Kaggle</a></p>
<p><a href="https://projecteuler.net/" class="external-link">Project Euler</a></p>
</section><section id="contact-us"><h2 class="section-heading">Contact us!<a class="anchor" aria-label="anchor" href="#contact-us"></a>
</h2>
<hr class="half-width">
<p>The whole reason for the existence of KUB Datalab is to help and
assist students (and teachers and researchers) working with data.</p>
<p>We do not guarantee that we will be able to solve your problems, but
we will do our best to help you.</p>
<p>Our <a href="https://kubkalender.kb.dk/calendar/datalab?cid=6416&amp;t=d&amp;d=0000-00-00&amp;cal=6416&amp;inc=0" class="external-link">calender</a>,
containing our activities, courses, seminars, datasprints etc.</p>
<p>Our <a href="https://kub.kb.dk/datalab" class="external-link">website</a></p>
<p>Our mail: <a href="mailto:kubdatalab@kb.dk" class="email">kubdatalab@kb.dk</a></p>
<div class="keypoints:">
<ul>
<li>‚ÄúPractice is important!‚Äù</li>
<li>‚ÄúWorking on data that YOU find interesting is a really good
idea,‚Äù</li>
<li>‚ÄúThe amount of ressources online is immense.‚Äù</li>
<li>‚ÄúKUB Datalab is there for your.‚Äù</li>
</ul>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-ignore-04-ggplot2"><p>Content from <a href="ignore-04-ggplot2.html">Data Visualisation with ggplot2</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/ignore-04-ggplot2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 115 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>We start by loading the required package.
<strong><code>ggplot2</code></strong> is also included in the
<strong><code>tidyverse</code></strong> package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>If not still in the workspace, load the data we saved in the previous
lesson.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data_output/interviews_plotting.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: 'data_output/interviews_plotting.csv' does not exist in current working directory ('/home/runner/work/R-intro/R-intro/site/built').</code></pre>
</div>
<p>If you were unable to complete the previous lesson or did not save
the data, then you can create it now.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Not run, but can be used to load in data from previous lesson!</span></span>
<span><span class="va">interviews_plotting</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## pivot wider by items_owned</span></span>
<span>  <span class="fu">separate_rows</span><span class="op">(</span><span class="va">items_owned</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## if there were no items listed, changing NA to no_listed_items</span></span>
<span>  <span class="fu">replace_na</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>items_owned <span class="op">=</span> <span class="st">"no_listed_items"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">items_owned</span>, </span>
<span>              values_from <span class="op">=</span> <span class="va">items_owned_logical</span>, </span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>items_owned_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## pivot wider by months_lack_food</span></span>
<span>  <span class="fu">separate_rows</span><span class="op">(</span><span class="va">months_lack_food</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">months_lack_food</span>, </span>
<span>              values_from <span class="op">=</span> <span class="va">months_lack_food_logical</span>, </span>
<span>              values_fill <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>months_lack_food_logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## add some summary columns</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>number_months_lack_food <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="va">Jan</span><span class="op">:</span><span class="va">May</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>number_items <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">.</span>, <span class="va">bicycle</span><span class="op">:</span><span class="va">car</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<section id="plotting-with-ggplot2"><h2 class="section-heading">Plotting with <strong><code>ggplot2</code></strong><a class="anchor" aria-label="anchor" href="#plotting-with-ggplot2"></a>
</h2>
<hr class="half-width">
<p><strong><code>ggplot2</code></strong> is a plotting package that
makes it simple to create complex plots from data stored in a data
frame. It provides a programmatic interface for specifying what
variables to plot, how they are displayed, and general visual
properties. Therefore, we only need minimal changes if the underlying
data change or if we decide to change from a bar plot to a scatterplot.
This helps in creating publication quality plots with minimal amounts of
adjustments and tweaking.</p>
<p><strong><code>ggplot2</code></strong> functions work best with data
in the ‚Äòlong‚Äô format, i.e., a column for every dimension, and a row for
every observation. Well-structured data will save you lots of time when
making figures with <strong><code>ggplot2</code></strong></p>
<p>ggplot graphics are built step by step by adding new elements. Adding
layers in this fashion allows for extensive flexibility and
customization of plots.</p>
<p>Each chart built with ggplot2 must include the following</p>
<ul>
<li><p>Data<br></p></li>
<li>
<p>Aesthetic mapping (aes)</p>
<ul>
<li>Describes how variables are mapped onto graphical attributes<br>
</li>
<li>Visual attribute of data including x-y axes, color, fill, shape, and
alpha<br>
</li>
</ul>
</li>
<li>
<p>Geometric objects (geom)</p>
<ul>
<li>Determines how values are rendered graphically, as bars
(<code>geom_bar</code>), scatterplot (<code>geom_point</code>), line
(<code>geom_line</code>), etc.</li>
</ul>
</li>
</ul>
<p>Thus, the template for graphic in ggplot2 is:</p>
<pre><code>&lt;DATA&gt; %&gt;%
    ggplot(aes(&lt;MAPPINGS&gt;)) +
    &lt;GEOM_FUNCTION&gt;()</code></pre>
<p>Remember from the last lesson that the pipe operator
<code>%&gt;%</code> places the result of the previous line(s) into the
first argument of the function. <strong><code>ggplot</code></strong> is
a function that expects a data frame to be the first argument. This
allows for us to change from specifying the <code>data =</code> argument
within the <code>ggplot</code> function and instead pipe the data into
the function.</p>
<ul>
<li>use the <code>ggplot()</code> function and bind the plot to a
specific data frame.</li>
</ul>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>define a mapping (using the aesthetic (<code>aes</code>) function),
by selecting the variables to be plotted and specifying how to present
them in the graph, e.g.¬†as x/y positions or characteristics such as
size, shape, color, etc.</li>
</ul>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>
<p>add ‚Äògeoms‚Äô ‚Äì graphical representations of the data in the plot
(points, lines, bars). <strong><code>ggplot2</code></strong> offers many
different geoms; we will use some common ones today, including:</p>
<ul>
<li>
<code>geom_point()</code> for scatter plots, dot plots, etc.</li>
<li>
<code>geom_boxplot()</code> for, well, boxplots!</li>
<li>
<code>geom_line()</code> for trend lines, time series, etc.</li>
</ul>
</li>
</ul>
<p>To add a geom to the plot use the <code>+</code> operator. Because we
have two continuous variables, let‚Äôs use <code>geom_point()</code>
first:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>The <code>+</code> in the <strong><code>ggplot2</code></strong>
package is particularly useful because it allows you to modify existing
<code>ggplot</code> objects. This means you can easily set up plot
templates and conveniently explore different types of plots, so the
above plot can also be generated with code like this, similar to the
‚Äúintermediate steps‚Äù approach in the previous lesson:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign plot to a variable</span></span>
<span><span class="va">interviews_plot</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw the plot as a dot plot</span></span>
<span><span class="va">interviews_plot</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<blockquote>
<h2 id="notes">Notes</h2>
<ul>
<li>Anything you put in the <code>ggplot()</code> function can be seen
by any geom layers that you add (i.e., these are universal plot
settings). This includes the x- and y-axis mapping you set up in
<code>aes()</code>.</li>
<li>You can also specify mappings for a given geom independently of the
mapping defined globally in the <code>ggplot()</code> function.</li>
<li>The <code>+</code> sign used to add new layers must be placed at the
end of the line containing the <em>previous</em> layer. If, instead, the
<code>+</code> sign is added at the beginning of the line containing the
new layer, <strong><code>ggplot2</code></strong> will not add the new
layer and will return an error message.</li>
</ul>
</blockquote>
<p>{: .callout}</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This is the correct syntax for adding layers</span></span>
<span><span class="va">interviews_plot</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## This will not add the new layer and will return an error message</span></span>
<span><span class="va">interviews_plot</span></span>
<span><span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="building-your-plots-iteratively"><h2 class="section-heading">Building your plots iteratively<a class="anchor" aria-label="anchor" href="#building-your-plots-iteratively"></a>
</h2>
<hr class="half-width">
<p>Building plots with <strong><code>ggplot2</code></strong> is
typically an iterative process. We start by defining the dataset we‚Äôll
use, lay out the axes, and choose a geom:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>Then, we start modifying this plot to extract more information from
it. For instance, when inspecting the plot we notice that points only
appear at the intersection of whole numbers of <code>no_membrs</code>
and <code>number_items</code>. Also, from a rough estimate, it looks
like there are far fewer dots on the plot than there rows in our
dataframe. This should lead us to believe that there may be multiple
observations plotted on top of each other (e.g.¬†three observations where
<code>no_membrs</code> is 3 and <code>number_items</code> is 1).</p>
<p>There are two main ways to alleviate overplotting issues: 1. changing
the transparency of the points 2. jittering the location of the
points</p>
<p>Let‚Äôs first explore option 1, changing the transparency of the
points. What we mean when we say ‚Äútransparency‚Äù we mean the opacity of
point, or your ability to see through the point. We can control the
transparency of the points with the <code>alpha</code> argument to
<code>geom_point</code>. Values of <code>alpha</code> range from 0 to 1,
with lower values corresponding to more transparent colors (an
<code>alpha</code> of 1 is the default value). Specifically, an alpha of
0.1, would make a point one-tenth as opaque as a normal point. Stated
differently ten points stacked on top of each other would correspond to
a normal point.</p>
<p>Here, we change the <code>alpha</code> to 0.5, in an attempt to help
fix the overplotting. While the overplotting isn‚Äôt solved, adding
transparency begins to address this problem, as the points where there
are overlapping observations are darker (as opposed to lighter
gray):</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>That only helped a little bit with the overplotting problem, so let‚Äôs
try option two. We can jitter the points on the plot, so that we can see
each point in the locations where there are overlapping points.
Jittering introduces a little bit of randomness into the position of our
points. You can think of this process as taking the overplotted graph
and giving it a tiny shake. The points will move a little bit
side-to-side and up-and-down, but their position from the original plot
won‚Äôt dramatically change.</p>
<p>We can jitter our points using the <code>geom_jitter()</code>
function instead of the <code>geom_point()</code> function, as seen
below:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>The <code>geom_jitter()</code> function allows for us to specify the
amount of random motion in the jitter, using the <code>width</code> and
<code>height</code> arguments. When we don‚Äôt specify values for
<code>width</code> and <code>height</code>, <code>geom_jitter()</code>
defaults to 40% of the resolution of the data (the smallest change that
can be measured). Hence, if we would like <em>less</em> spread in our
jitter than was default, we should pick values between 0.1 and 0.4.
Experiment with the values to see how your plot changes.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>For our final change, we can also add colours for all the points by
specifying a <code>color</code> argument inside the
<code>geom_jitter()</code> function:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>To colour each village in the plot differently, you could use a
vector as an input to the argument <strong><code>color</code></strong>.
However, because we are now mapping features of the data to a colour,
instead of setting one colour for all points, the colour of the points
now needs to be set inside a call to the
<strong><code>aes</code></strong> function. When we map a variable in
our data to the colour of the points,
<strong><code>ggplot2</code></strong> will provide a different colour
corresponding to the different values of the variable. We will continue
to specify the value of <strong><code>alpha</code></strong>,
<strong><code>width</code></strong>, and
<strong><code>height</code></strong> outside of the
<strong><code>aes</code></strong> function because we are using the same
value for every point. ggplot2 understands both the Commonwealth English
and American English spellings for colour, i.e., you can use either
<code>color</code> or <code>colour</code>. Here is an example where we
color points by the <strong><code>village</code></strong> of the
observation:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">village</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>There appears to be a positive trend between number of household
members and number of items owned (from the list provided).
Additionally, this trend does not appear to be different by village.</p>
<blockquote>
<h2 id="notes-1">Notes</h2>
<p>As you will learn, there are multiple ways to plot the a relationship
between variables. Another way to plot data with overlapping points is
to use the <code>geom_count</code> plotting function. The
<code>geom_count()</code> function makes the size of each point
representative of the number of data items of that type and the legend
gives point sizes associated to particular numbers of items.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">no_membrs</span>, y <span class="op">=</span> <span class="va">number_items</span>, color <span class="op">=</span> <span class="va">village</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_count</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
</blockquote>
<p>{: .callout}</p>
<blockquote>
<h2 id="exercise">Exercise</h2>
<p>Use what you just learned to create a scatter plot of
<code>rooms</code> by <code>village</code> with the
<code>respondent_wall_type</code> showing in different colours. Does
this seem like a good way to display the relationship between these
variables? What other kinds of plots might you use to show this type of
data?</p>
<blockquote>
<h2 id="solution">Solution</h2>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>This is not a great way to show this type of data because it is
difficult to distinguish between villages. What other plot types could
help you visualize this relationship better? {: .solution} {:
.challenge}</p>
</blockquote>
</blockquote>
</section><section id="boxplot"><h2 class="section-heading">Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"></a>
</h2>
<hr class="half-width">
<p>We can use boxplots to visualize the distribution of rooms for each
wall type:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>By adding points to a boxplot, we can have a better idea of the
number of measurements and of their distribution:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"tomato"</span>,</span>
<span>        width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>We can see that muddaub houses and sunbrick houses tend to be smaller
than burntbrick houses.</p>
<p>Notice how the boxplot layer is behind the jitter layer? What do you
need to change in the code to put the boxplot in behind the points such
that it‚Äôs not hidden?</p>
<blockquote>
<h2 id="exercise-1">Exercise</h2>
<p>Boxplots are useful summaries, but hide the <em>shape</em> of the
distribution. For example, if the distribution is bimodal, we would not
see it in a boxplot. An alternative to the boxplot is the violin plot,
where the shape (of the density of points) is drawn.</p>
<ul>
<li>Replace the box plot with a violin plot; see
<code>geom_violin()</code>.</li>
</ul>
<blockquote>
<h2 id="solution-1">Solution</h2>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">rooms</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>{: .solution}</p>
</blockquote>
<p>So far, we‚Äôve looked at the distribution of room number within wall
type. Try making a new plot to explore the distribution of another
variable within wall type.</p>
<ul>
<li>Create a boxplot for <code>liv_count</code> for each wall type.
Overlay the boxplot layer on a jitter layer to show actual
measurements.</li>
</ul>
<blockquote>
<h2 id="solution-2">Solution</h2>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">liv_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_jitter</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>{: .solution}</p>
</blockquote>
<ul>
<li>Add colour to the data points on your boxplot according to whether
the respondent is a member of an irrigation association
(<code>memb_assoc</code>).</li>
</ul>
<blockquote>
<h2 id="solution-3">Solution</h2>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">liv_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">memb_assoc</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</section><section id="barplots"><h2 class="section-heading">Barplots<a class="anchor" aria-label="anchor" href="#barplots"></a>
</h2>
<hr class="half-width">
<p>Barplots are also useful for visualizing categorical data. By
default, <code>geom_bar</code> accepts a variable for x, and plots the
number of instances each value of x (in this case, wall type) appears in
the dataset.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>We can use the <code>fill</code> aesthetic for the
<code>geom_bar()</code> geom to colour bars by the portion of each count
that is from each village.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">village</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>This creates a stacked bar chart. These are generally more difficult
to read than side-by-side bars. We can separate the portions of the
stacked bar that correspond to each village and put them side-by-side by
using the <code>position</code> argument for <code>geom_bar()</code> and
setting it to ‚Äúdodge‚Äù.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">village</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>This is a nicer graphic, but we‚Äôre more likely to be interested in
the proportion of each housing type in each village than in the actual
count of number of houses of each type (because we might have sampled
different numbers of households in each village). To compare
proportions, we will first create a new data frame
(<code>percent_wall_type</code>) with a new column named ‚Äúpercent‚Äù
representing the percent of each house type in each village. We will
remove houses with cement walls, as there was only one in the
dataset.</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">filter</span><span class="op">(</span><span class="va">respondent_wall_type</span> <span class="op">!=</span> <span class="st">"cement"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">count</span><span class="op">(</span><span class="va">village</span>, <span class="va">respondent_wall_type</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>percent <span class="op">=</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>Now we can use this new data frame to create our plot showing the
percentage of each house type in each village.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span>, fill <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_wall_type' not found</code></pre>
</div>
<blockquote>
<h2 id="exercise-2">Exercise</h2>
<p>Create a bar plot showing the proportion of respondents in each
village who are or are not part of an irrigation association
(<code>memb_assoc</code>). Include only respondents who answered that
question in the calculations and plot. Which village had the lowest
proportion of respondents in an irrigation association?</p>
<blockquote>
<h2 id="solution-4">Solution</h2>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_memb_assoc</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">village</span>, <span class="va">memb_assoc</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>percent <span class="op">=</span> <span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_memb_assoc</span> <span class="op">%&gt;%</span></span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span>, fill <span class="op">=</span> <span class="va">memb_assoc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_memb_assoc' not found</code></pre>
</div>
<p>Ruaca had the lowest proportion of members in an irrigation
association. {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</section><section id="adding-labels-and-titles"><h2 class="section-heading">Adding Labels and Titles<a class="anchor" aria-label="anchor" href="#adding-labels-and-titles"></a>
</h2>
<hr class="half-width">
<p>By default, the axes labels on a plot are determined by the name of
the variable being plotted. However,
<strong><code>ggplot2</code></strong> offers lots of customization
options, like specifying the axes labels, and adding a title to the plot
with relatively few lines of code. We will add more informative x-and
y-axis labels to our plot, a more explanatory label to the legend, and a
plot title.</p>
<p>The <code>labs</code> function takes the following arguments:</p>
<ul>
<li>
<code>title</code> ‚Äì to produce a plot title</li>
<li>
<code>subtitle</code> ‚Äì to produce a plot subtitle (smaller text
placed beneath the title)</li>
<li>
<code>caption</code> ‚Äì a caption for the plot</li>
<li>
<code>...</code> ‚Äì any pair of name and value for aesthetics used in
the plot (e.g., <code>x</code>, <code>y</code>, <code>fill</code>,
<code>color</code>, <code>size</code>)</li>
</ul>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span>, fill <span class="op">=</span> <span class="va">respondent_wall_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Proportion of wall type by village"</span>,</span>
<span>         fill <span class="op">=</span> <span class="st">"Type of Wall in Home"</span>, </span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_wall_type' not found</code></pre>
</div>
</section><section id="faceting"><h2 class="section-heading">Faceting<a class="anchor" aria-label="anchor" href="#faceting"></a>
</h2>
<hr class="half-width">
<p>Rather than creating a single plot with side-by-side bars for each
village, we may want to create multiple plot, where each plot shows the
data for a single village. This would be especially useful if we had a
large number of villages that we had sampled, as a large number of
side-by-side bars will become more difficult to read.</p>
<p><strong><code>ggplot2</code></strong> has a special technique called
<em>faceting</em> that allows the user to split one plot into multiple
plots based on a factor included in the dataset. We will use it to split
our barplot of housing type proportion by village so that each village
has it‚Äôs own panel in a multi-panel plot:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Proportion of wall type by village"</span>,</span>
<span>         x<span class="op">=</span><span class="st">"Wall Type"</span>,</span>
<span>         y<span class="op">=</span><span class="st">"Percent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">village</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_wall_type' not found</code></pre>
</div>
<p>Click the ‚ÄúZoom‚Äù button in your RStudio plots pane to view a larger
version of this plot.</p>
<p>Usually plots with white background look more readable when printed.
We can set the background to white using the function
<code>theme_bw()</code>. Additionally, you can remove the grid:</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_wall_type</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">respondent_wall_type</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title<span class="op">=</span><span class="st">"Proportion of wall type by village"</span>,</span>
<span>         x<span class="op">=</span><span class="st">"Wall Type"</span>,</span>
<span>         y<span class="op">=</span><span class="st">"Percent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">village</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_wall_type' not found</code></pre>
</div>
<p>What if we wanted to see the proportion of respondents in each
village who owned a particular item? We can calculate the percent of
people in each village who own each item and then create a faceted
series of bar plots where each plot is a particular item. First we need
to calculate the percentage of people in each village who own each
item:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">&lt;-</span> <span class="va">interviews_plotting</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">village</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">bicycle</span><span class="op">:</span><span class="va">no_listed_items</span>, <span class="op">~</span> <span class="fu">sum</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">/</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">bicycle</span><span class="op">:</span><span class="va">no_listed_items</span>, names_to <span class="op">=</span> <span class="st">"items"</span>, values_to <span class="op">=</span> <span class="st">"percent"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>To calculate this percentage data frame, we needed to use the
<code>across()</code> function within a <code>summarize()</code>
operation. Unlike the previous example with a single wall type variable,
where each response was exactly one of the types specified, people can
(and do) own more than one item. So there are multiple columns of data
(one for each item), and the percentage calculation needs to be repeated
for each column.</p>
<p>Combining <code>summarize()</code> with <code>across()</code> allows
us to specify first, the columns to be summarized
(<code>bicycle:no_listed_items</code>) and then the calculation. Because
our calculation is a bit more complex than is available in a built-in
function, we define a new formula: * <code>~</code> indicates that we
are defining a formula, * <code>sum(.x)</code> gives the number of
people owning that item by counting the number of <code>TRUE</code>
values (<code>.x</code> is shorthand for the column being operated on),
* and <code>n()</code> gives the current group size.</p>
<p>After the <code>summarize()</code> operation, we have a table of
percentages with each item in its own column, so a
<code>pivot_longer()</code> is required to transform the table into an
easier format for plotting. Using this data frame, we can now create a
multi-paneled bar plot.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_items' not found</code></pre>
</div>
</section><section id="ggplot2-themes"><h2 class="section-heading">
<strong><code>ggplot2</code></strong> themes<a class="anchor" aria-label="anchor" href="#ggplot2-themes"></a>
</h2>
<hr class="half-width">
<p>In addition to <code>theme_bw()</code>, which changes the plot
background to white, <strong><code>ggplot2</code></strong> comes with
several other themes which can be useful to quickly change the look of
your visualization. The complete list of themes is available at <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link uri">https://ggplot2.tidyverse.org/reference/ggtheme.html</a>.
<code>theme_minimal()</code> and <code>theme_light()</code> are popular,
and <code>theme_void()</code> can be useful as a starting point to
create a new hand-crafted theme.</p>
<p>The <a href="https://jrnold.github.io/ggthemes/reference/index.html" class="external-link">ggthemes</a>
package provides a wide variety of options (including an Excel 2003
theme). The <a href="https://exts.ggplot2.tidyverse.org/" class="external-link"><strong><code>ggplot2</code></strong>
extensions website</a> provides a list of packages that extend the
capabilities of <strong><code>ggplot2</code></strong>, including
additional themes.</p>
<blockquote>
<h2 id="exercise-3">Exercise</h2>
<p>Experiment with at least two different themes. Build the previous
plot using each of those themes. Which do you like best? {:
.challenge}</p>
</blockquote>
</section><section id="customization"><h2 class="section-heading">Customization<a class="anchor" aria-label="anchor" href="#customization"></a>
</h2>
<hr class="half-width">
<p>Take a look at the <a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf" class="external-link"><strong><code>ggplot2</code></strong>
cheat sheet</a>, and think of ways you could improve the plot.</p>
<p>Now, let‚Äôs change names of axes to something more informative than
‚Äòvillage‚Äô and ‚Äòpercent‚Äô and add a title to the figure:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_items' not found</code></pre>
</div>
<p>The axes have more informative names, but their readability can be
improved by increasing the font size:</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_items' not found</code></pre>
</div>
<p>Note that it is also possible to change the fonts of your plots. If
you are on Windows, you may have to install the <a href="https://github.com/wch/extrafont" class="external-link"><strong><code>extrafont</code></strong>
package</a>, and follow the instructions included in the README for this
package.</p>
<p>After our manipulations, you may notice that the values on the x-axis
are still not properly readable. Let‚Äôs change the orientation of the
labels and adjust them vertically and horizontally so they don‚Äôt
overlap. You can use a 90-degree angle, or experiment to find the
appropriate angle for diagonally oriented labels. With a larger font,
the title also runs off. We can add ‚Äú‚Äù in the string for the title to
insert a new line:</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village \n who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span>, angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                                     hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>          text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_items' not found</code></pre>
</div>
<p>If you like the changes you created better than the default theme,
you can save them as an object to be able to easily apply them to other
plots you may create. We can also add
<code>plot.title = element_text(hjust = 0.5)</code> to centre the
title:</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grey_theme</span> <span class="op">&lt;-</span> <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                                               angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                               vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                    axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                    text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>                    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village \n who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">grey_theme</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'percent_items' not found</code></pre>
</div>
<blockquote>
<h2 id="exercise-4">Exercise</h2>
<p>With all of this information in hand, please take another five
minutes to either improve one of the plots generated in this exercise or
create a beautiful graph of your own. Use the RStudio <a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf" class="external-link"><strong><code>ggplot2</code></strong>
cheat sheet</a> for inspiration. Here are some ideas:</p>
<ul>
<li>See if you can make the bars white with black outline.</li>
<li>Try using a different colour palette (see <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/" class="external-link">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</a>).
{: .challenge}</li>
</ul>
</blockquote>
<p>After creating your plot, you can save it to a file in your favourite
format. The Export tab in the <strong>Plot</strong> pane in RStudio will
save your plots at low resolution, which will not be accepted by many
journals and will not scale well for posters.</p>
<p>Instead, use the <code>ggsave()</code> function, which allows you
easily change the dimension and resolution of your plot by adjusting the
appropriate arguments (<code>width</code>, <code>height</code> and
<code>dpi</code>).</p>
<p>Make sure you have the <code>fig_output/</code> folder in your
working directory.</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_plot</span> <span class="op">&lt;-</span> <span class="va">percent_items</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">village</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">items</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Percent of respondents in each village \n who owned each item"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Village"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Percent of Respondents"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span>, angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                                     hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey20"</span>, size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>          text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>          plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"fig_output/name_of_file.png"</span>, <span class="va">my_plot</span>, width <span class="op">=</span> <span class="fl">15</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p>Note: The parameters <code>width</code> and <code>height</code> also
determine the font size in the saved plot.</p>
<p>{% include links.md %}</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-ignore-05-databases"><p>Content from <a href="ignore-05-databases.html">Using a relational database with R</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/ignore-05-databases.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A common problem with R in that all operations are conducted
in-memory. Here, ‚Äúmemory‚Äù means a computer drive called Random Access
Memory (RAM for short) which is phsically installed on your computer.
RAM allows for data to be read in nearly the same amount of time
regardless of its physical location inside the memory. This is in stark
contrast to the speed data could be read from CDs, DVDs, or other
storage media, where the speed of transfer depended on how quickly the
drive could rotate or the arm could move. Unfortunately, your computer
has a limited amount of RAM, so the amount of data you can work with is
limited by the available memory. So far, we have used small datasets
that can easily fit into your computer‚Äôs memory. But what about datasets
that are too large for your computer to handle as a whole?</p>
<p>In this case, it is helpful to organze the data into a database
stored outside of R before creating a connection to the database itself.
This connection will essentially remove the limitation of memory because
SQL queries can be sent directly from R to the database and return to R
only the results that you have identified as being neccessary for your
analysis.</p>
<p>Once we have made the connection to the database, much of what we do
will look familiar because the code we will be using is very similar to
what we saw in the SQL lesson and earlier episodes of this R lesson.</p>
<p>In this lesson, we will be connecting to an SQLite database, which
allows us to send strings containing SQL statements directly from R to
the database and recieve the results. In addition, we will be connecting
to the database in such a way that we can use ‚Äòdplyr‚Äô functions to
operate directly on the database tables.</p>
</section><section id="prelminaries"><h2 class="section-heading">Prelminaries<a class="anchor" aria-label="anchor" href="#prelminaries"></a>
</h2>
<hr class="half-width">
<p>First, install and load the neccessary packages. You can install the
<code>RSQLite</code> package with</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"RSQLite"</span><span class="op">)</span></span></code></pre>
</div>
<p>Load the packages with</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">RSQLite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<p>Next, create a variable that contains the location of the SQLite
database we are going to use. Here, we are assuming that it is in the
current working directory.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbfile</span> <span class="op">&lt;-</span> <span class="st">"data/SN7577.sqlite"</span></span></code></pre>
</div>
</section><section id="connecting-to-an-sqlite-database"><h2 class="section-heading">Connecting to an SQLite Database<a class="anchor" aria-label="anchor" href="#connecting-to-an-sqlite-database"></a>
</h2>
<hr class="half-width">
<p>Connect to the SQLite database specified by <code>dbfile</code>,
above, using the <code>dbConnect</code> function.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydb</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">dbDriver</span><span class="op">(</span><span class="st">"SQLite"</span><span class="op">)</span>, <span class="va">dbfile</span><span class="op">)</span></span></code></pre>
</div>
<p>Here, <code>mydb</code> represents the connection to the database. It
will be specified every time we need to access the database.</p>
<p>Now that we have a connection, we can get a list of the tables in the
database.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">mydb</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">character</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<p>Our objective here is to bring data from the database into R by
sending a query to the database and then asking for the results of that
query.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign the results of a SQL query to an SQLiteResult object</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">dbSendQuery</span><span class="op">(</span><span class="va">mydb</span>, <span class="st">"SELECT * FROM Question1"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: no such table: Question1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return results from a custom object to a dataframe</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'res' in selecting a method for function 'fetch': object 'results' not found</code></pre>
</div>
<p><code>data</code> is a standard R dataframe that can be explored and
manipulated.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return column names</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="cn">NULL</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return description of dataframe structure</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function (..., list = character(), package = NULL, lib.loc = NULL, verbose = getOption("verbose"), 
    envir = .GlobalEnv, overwrite = TRUE)  </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return the second column</span></span>
<span><span class="va">data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data[, 2]: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return the value of the second column, fourth row</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data[4, 2]: object of type 'closure' is not subsettable</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return the second column where the value of the column 'key' is greater than 7</span></span>
<span><span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">key</span> <span class="op">&gt;</span> <span class="fl">7</span>,<span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data$key: object of type 'closure' is not subsettable</code></pre>
</div>
<p>Once you have retrieved the data you should close the connection.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbClearResult</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'res' in selecting a method for function 'dbClearResult': object 'results' not found</code></pre>
</div>
<p>In addition to sending simple queries we can send complex one like a
join. You may want to set this up in a concateneted string first for
readability.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SQL_query</span> <span class="op">&lt;-</span> <span class="fu">paste</span><span class="op">(</span><span class="st">"SELECT q.value,"</span>,</span>
<span>                   <span class="st">"count(*) as how_many"</span>,</span>
<span>                   <span class="st">"FROM SN7577 s"</span>,</span>
<span>                   <span class="st">"JOIN Question1  q"</span>,</span>
<span>                   <span class="st">"ON q.key = s.Q1"</span>,</span>
<span>                   <span class="st">"GROUP BY  s.Q1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">dbSendQuery</span><span class="op">(</span><span class="va">mydb</span>, <span class="va">SQL_query</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: no such table: SN7577</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'res' in selecting a method for function 'fetch': object 'results' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>function (..., list = character(), package = NULL, lib.loc = NULL, 
    verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE) 
{
    fileExt &lt;- function(x) {
        db &lt;- grepl("\\.[^.]+\\.(gz|bz2|xz)$", x)
        ans &lt;- sub(".*\\.", "", x)
        ans[db] &lt;- sub(".*\\.([^.]+\\.)(gz|bz2|xz)$", "\\1\\2", 
            x[db])
        ans
    }
    my_read_table &lt;- function(...) {
        lcc &lt;- Sys.getlocale("LC_COLLATE")
        on.exit(Sys.setlocale("LC_COLLATE", lcc))
        Sys.setlocale("LC_COLLATE", "C")
        read.table(...)
    }
    stopifnot(is.character(list))
    names &lt;- c(as.character(substitute(list(...))[-1L]), list)
    if (!is.null(package)) {
        if (!is.character(package)) 
            stop("'package' must be a character vector or NULL")
    }
    paths &lt;- find.package(package, lib.loc, verbose = verbose)
    if (is.null(lib.loc)) 
        paths &lt;- c(path.package(package, TRUE), if (!length(package)) getwd(), 
            paths)
    paths &lt;- unique(normalizePath(paths[file.exists(paths)]))
    paths &lt;- paths[dir.exists(file.path(paths, "data"))]
    dataExts &lt;- tools:::.make_file_exts("data")
    if (length(names) == 0L) {
        db &lt;- matrix(character(), nrow = 0L, ncol = 4L)
        for (path in paths) {
            entries &lt;- NULL
            packageName &lt;- if (file_test("-f", file.path(path, 
                "DESCRIPTION"))) 
                basename(path)
            else "."
            if (file_test("-f", INDEX &lt;- file.path(path, "Meta", 
                "data.rds"))) {
                entries &lt;- readRDS(INDEX)
            }
            else {
                dataDir &lt;- file.path(path, "data")
                entries &lt;- tools::list_files_with_type(dataDir, 
                  "data")
                if (length(entries)) {
                  entries &lt;- unique(tools::file_path_sans_ext(basename(entries)))
                  entries &lt;- cbind(entries, "")
                }
            }
            if (NROW(entries)) {
                if (is.matrix(entries) &amp;&amp; ncol(entries) == 2L) 
                  db &lt;- rbind(db, cbind(packageName, dirname(path), 
                    entries))
                else warning(gettextf("data index for package %s is invalid and will be ignored", 
                  sQuote(packageName)), domain = NA, call. = FALSE)
            }
        }
        colnames(db) &lt;- c("Package", "LibPath", "Item", "Title")
        footer &lt;- if (missing(package)) 
            paste0("Use ", sQuote(paste("data(package =", ".packages(all.available = TRUE))")), 
                "\n", "to list the data sets in all *available* packages.")
        else NULL
        y &lt;- list(title = "Data sets", header = NULL, results = db, 
            footer = footer)
        class(y) &lt;- "packageIQR"
        return(y)
    }
    paths &lt;- file.path(paths, "data")
    for (name in names) {
        found &lt;- FALSE
        for (p in paths) {
            tmp_env &lt;- if (overwrite) 
                envir
            else new.env()
            if (file_test("-f", file.path(p, "Rdata.rds"))) {
                rds &lt;- readRDS(file.path(p, "Rdata.rds"))
                if (name %in% names(rds)) {
                  found &lt;- TRUE
                  if (verbose) 
                    message(sprintf("name=%s:\t found in Rdata.rds", 
                      name), domain = NA)
                  thispkg &lt;- sub(".*/([^/]*)/data$", "\\1", p)
                  thispkg &lt;- sub("_.*$", "", thispkg)
                  thispkg &lt;- paste0("package:", thispkg)
                  objs &lt;- rds[[name]]
                  lazyLoad(file.path(p, "Rdata"), envir = tmp_env, 
                    filter = function(x) x %in% objs)
                  break
                }
                else if (verbose) 
                  message(sprintf("name=%s:\t NOT found in names() of Rdata.rds, i.e.,\n\t%s\n", 
                    name, paste(names(rds), collapse = ",")), 
                    domain = NA)
            }
            if (file_test("-f", file.path(p, "Rdata.zip"))) {
                warning("zipped data found for package ", sQuote(basename(dirname(p))), 
                  ".\nThat is defunct, so please re-install the package.", 
                  domain = NA)
                if (file_test("-f", fp &lt;- file.path(p, "filelist"))) 
                  files &lt;- file.path(p, scan(fp, what = "", quiet = TRUE))
                else {
                  warning(gettextf("file 'filelist' is missing for directory %s", 
                    sQuote(p)), domain = NA)
                  next
                }
            }
            else {
                files &lt;- list.files(p, full.names = TRUE)
            }
            files &lt;- files[grep(name, files, fixed = TRUE)]
            if (length(files) &gt; 1L) {
                o &lt;- match(fileExt(files), dataExts, nomatch = 100L)
                paths0 &lt;- dirname(files)
                paths0 &lt;- factor(paths0, levels = unique(paths0))
                files &lt;- files[order(paths0, o)]
            }
            if (length(files)) {
                for (file in files) {
                  if (verbose) 
                    message("name=", name, ":\t file= ...", .Platform$file.sep, 
                      basename(file), "::\t", appendLF = FALSE, 
                      domain = NA)
                  ext &lt;- fileExt(file)
                  if (basename(file) != paste0(name, ".", ext)) 
                    found &lt;- FALSE
                  else {
                    found &lt;- TRUE
                    zfile &lt;- file
                    zipname &lt;- file.path(dirname(file), "Rdata.zip")
                    if (file.exists(zipname)) {
                      Rdatadir &lt;- tempfile("Rdata")
                      dir.create(Rdatadir, showWarnings = FALSE)
                      topic &lt;- basename(file)
                      rc &lt;- .External(C_unzip, zipname, topic, 
                        Rdatadir, FALSE, TRUE, FALSE, FALSE)
                      if (rc == 0L) 
                        zfile &lt;- file.path(Rdatadir, topic)
                    }
                    if (zfile != file) 
                      on.exit(unlink(zfile))
                    switch(ext, R = , r = {
                      library("utils")
                      sys.source(zfile, chdir = TRUE, envir = tmp_env)
                    }, RData = , rdata = , rda = load(zfile, 
                      envir = tmp_env), TXT = , txt = , tab = , 
                      tab.gz = , tab.bz2 = , tab.xz = , txt.gz = , 
                      txt.bz2 = , txt.xz = assign(name, my_read_table(zfile, 
                        header = TRUE, as.is = FALSE), envir = tmp_env), 
                      CSV = , csv = , csv.gz = , csv.bz2 = , 
                      csv.xz = assign(name, my_read_table(zfile, 
                        header = TRUE, sep = ";", as.is = FALSE), 
                        envir = tmp_env), found &lt;- FALSE)
                  }
                  if (found) 
                    break
                }
                if (verbose) 
                  message(if (!found) 
                    "*NOT* ", "found", domain = NA)
            }
            if (found) 
                break
        }
        if (!found) {
            warning(gettextf("data set %s not found", sQuote(name)), 
                domain = NA)
        }
        else if (!overwrite) {
            for (o in ls(envir = tmp_env, all.names = TRUE)) {
                if (exists(o, envir = envir, inherits = FALSE)) 
                  warning(gettextf("an object named %s already exists and will not be overwritten", 
                    sQuote(o)))
                else assign(o, get(o, envir = tmp_env, inherits = FALSE), 
                  envir = envir)
            }
            rm(tmp_env)
        }
    }
    invisible(names)
}
&lt;bytecode: 0x55f58f349590&gt;
&lt;environment: namespace:utils&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbClearResult</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'res' in selecting a method for function 'dbClearResult': object 'results' not found</code></pre>
</div>
<blockquote>
<h2 id="exercise">Exercise</h2>
<p>What happens if you send invalid SQL syntax?</p>
<blockquote>
<h2 id="solution">Solution</h2>
<p>An error message is returned from SQLite. Notice that R is just the
conduit; it cannot check the SQL syntax.</p>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>We can also create a new database and add tables to it. Let‚Äôs base
this new dataframe on the Question1 table that can be found in our
existing database.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, use a SQL query to extract the Question1 table from the existing database</span></span>
<span><span class="va">results</span> <span class="op">=</span> <span class="fu">dbSendQuery</span><span class="op">(</span><span class="va">mydb</span>, <span class="st">"SELECT * from Question1"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: no such table: Question1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Then, store it as a dataframe</span></span>
<span><span class="va">Q1</span> <span class="op">&lt;-</span> <span class="fu">fetch</span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'res' in selecting a method for function 'fetch': object 'results' not found</code></pre>
</div>
<p>Now, we can create the new database and add data to it, either from
an external file or a local dataframe.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbfile_new</span> <span class="op">=</span> <span class="st">"data/a_newdb.sqlite"</span></span>
<span><span class="va">mydb_new</span> <span class="op">=</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">dbDriver</span><span class="op">(</span><span class="st">"SQLite"</span><span class="op">)</span>, <span class="va">dbfile_new</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dbWriteTable</span><span class="op">(</span>conn <span class="op">=</span> <span class="va">mydb_new</span> , name <span class="op">=</span> <span class="st">"SN7577"</span>, value <span class="op">=</span> <span class="st">"data/SN7577.csv"</span>,</span>
<span>             row.names <span class="op">=</span> <span class="cn">FALSE</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in file(file, "rt"): cannot open file 'data/SN7577.csv': No such file
or directory</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in file(file, "rt"): cannot open the connection</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbWriteTable</span><span class="op">(</span>conn <span class="op">=</span> <span class="va">mydb_new</span> , name <span class="op">=</span> <span class="st">"Q1"</span>, value <span class="op">=</span> <span class="va">Q1</span>,</span>
<span>             row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'value' in selecting a method for function 'dbWriteTable': object 'Q1' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">mydb_new</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">character</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="connecting-to-a-database-for-dplyr-use"><h2 class="section-heading">Connecting to a Database for <code>dplyr</code> Use<a class="anchor" aria-label="anchor" href="#connecting-to-a-database-for-dplyr-use"></a>
</h2>
<hr class="half-width">
<p>When we want to use <code>dplyr</code> functions to operate directly
on the database tables, a different connection method is used.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydb_dplyr</span> <span class="op">&lt;-</span> <span class="fu">src_sqlite</span><span class="op">(</span>path<span class="op">=</span><span class="st">"data/SN7577.sqlite"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: `src_sqlite()` was deprecated in dplyr 1.0.0.
‚Ñπ Please use `tbl()` directly with a database connection
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
</div>
<p>as is the method for running queries. However using the ‚Äòtbl‚Äô
function we still need to provide avalid SQL string. (?)</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tbl</span><span class="op">(</span><span class="va">mydb_dplyr</span>, <span class="fu">sql</span><span class="op">(</span><span class="st">"SELECT count(*) from SN7577"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `db_query_fields.DBIConnection()`:
! Can't query fields.
Caused by error:
! no such table: SN7577</code></pre>
</div>
<p>The real advantage of using <code>dplyr</code> is that once we have
stored the table as an object (here, <code>SN7577_d</code>), we can use
<code>dplyr</code> functions instead of SQL statements.</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store the table as an object</span></span>
<span><span class="va">SN7577_d</span> <span class="op">&lt;-</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">mydb_dplyr</span>, <span class="fu">sql</span><span class="op">(</span><span class="st">"SELECT * FROM SN7577"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `db_query_fields.DBIConnection()`:
! Can't query fields.
Caused by error:
! no such table: SN7577</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Explore the object</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">SN7577_d</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'SN7577_d' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nrow</span><span class="op">(</span><span class="va">SN7577_d</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'SN7577_d' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply dplyr functions to the object</span></span>
<span><span class="va">SN7577_d</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">numage</span> <span class="op">&gt;</span> <span class="fl">60</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">sex</span>, <span class="va">age</span>, <span class="va">numage</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span>, <span class="va">age</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>avg_age <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">numage</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'SN7577_d' not found</code></pre>
</div>
<p>Notice that on the <code>nrow</code> command we get NA rather than a
count of rows. Thisis because <code>dplyr</code> doesn‚Äôt hold the full
table even after the ‚ÄòSelect * ‚Ä¶‚Äô</p>
<p>If you need the row count you can use</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SN7577_d</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'SN7577_d' not found</code></pre>
</div>
<blockquote>
<h2 id="exercise-1">Exercise</h2>
<p>Store the SN7577 table as an object for <code>dplyr</code> use.</p>
<p>Write a query using <code>dplyr</code> functions that will return the
average age (<code>numage</code>) by sex for all records where the
response for Q2 is missing (missing values are indicated by a value of
-1).</p>
<blockquote>
<h2 id="solution-1">Solution</h2>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SN7577_d</span> <span class="op">&lt;-</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">mydb_dplyr</span>, <span class="fu">sql</span><span class="op">(</span><span class="st">"SELECT * FROM SN7577"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `db_query_fields.DBIConnection()`:
! Can't query fields.
Caused by error:
! no such table: SN7577</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SN7577_d</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">Q2</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>   <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>   <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>avg_age <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">numage</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'SN7577_d' not found</code></pre>
</div>
<p>{: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>{% include links.md %}</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-ignore-05-json"><p>Content from <a href="ignore-05-json.html">Processing JSON data</a></p>
<hr>
<p>Last updated on 2023-12-20 |
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/episodes/ignore-05-json.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section id="the-json-data-format"><h2 class="section-heading">The JSON data format<a class="anchor" aria-label="anchor" href="#the-json-data-format"></a>
</h2>
<hr class="half-width">
<p>The JSON data format was designed as a way of allowing different
machines or processes within machines to communicate with each other by
sending messages constructed in a well defined format. JSON is now the
preferred data format used by APIs (Application Programming
Interfaces).</p>
<p>The JSON format although somewhat verbose is not only Human readable
but it can also be mapped very easily to an R dataframe.</p>
<p>We are going to read a file of data formatted as JSON, convert it
into a dataframe in R then selectively create a csv file from the
extracted data.</p>
<p>The JSON file we are going to use is the <a href="../data/SAFI.json">SAFI.json</a> file. This is the output file from
an electronic survey system called ODK. The JSON represents the answers
to a series of survey questions. The questions themselves have been
replaced with unique Keys, the values are the answers.</p>
<p>Because detailed surveys are by nature nested structures making it
possible to record different levels of detail or selectively ask a set
of specific questions based on the answer given a previous question, the
structure of the answers for the survey can not only be complex and
convoluted, it could easily be different from one survey respondent‚Äôs
set of answers to another.</p>
<div class="section level3">
<h3 id="advantages-of-json">Advantages of JSON<a class="anchor" aria-label="anchor" href="#advantages-of-json"></a>
</h3>
<ul>
<li>Very popular data format for APIs (e.g.¬†results from an Internet
search)</li>
<li>Human readable</li>
<li>Each record (or document as they are called) is self contained. The
equivalent of the column name and column values are in every
record.</li>
<li>Documents do not all have to have the same structure within the same
file</li>
<li>Document structures can be complex and nested</li>
</ul>
</div>
<div class="section level3">
<h3 id="disadvantages-of-json">Disadvantages of JSON<a class="anchor" aria-label="anchor" href="#disadvantages-of-json"></a>
</h3>
<ul>
<li>It is more verbose than the equivalent data in csv format</li>
<li>Can be more difficult to process and display than csv formatted
data</li>
</ul>
</div>
</section><section id="use-the-json-package-to-read-a-json-file"><h2 class="section-heading">Use the JSON package to read a JSON file<a class="anchor" aria-label="anchor" href="#use-the-json-package-to-read-a-json-file"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'jsonlite'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:purrr':

    flatten</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="fu">read_json</span><span class="op">(</span>path<span class="op">=</span><span class="st">'data/SAFI.json'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in open.connection(con, "rb"): cannot open file 'data/SAFI.json': No
such file or directory</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in open.connection(con, "rb"): cannot open the connection</code></pre>
</div>
<p>We can see that a new object called json_data has appeared in our
Environment. It is described as a Large list (131 elements). In this
current form, our data is messy. You can have a glimpse of it with the
<code>head()</code> or <code>view()</code> functions. It will look not
much more structured than if you were to open the JSON file with a text
editor.</p>
<p>This is because, by default, the <code>read_json()</code> function‚Äôs
parameter <code>simplifyVector</code>, which specifies whether or not to
simplify vectors is set to FALSE. This means that the default setting
does not simplify nested lists into vectors and data frames. However, we
can set this to TRUE, and our data will be read directly as a
dataframe:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="fu">read_json</span><span class="op">(</span>path<span class="op">=</span><span class="st">'data/SAFI.json'</span>, simplifyVector <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in open.connection(con, "rb"): cannot open file 'data/SAFI.json': No
such file or directory</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in open.connection(con, "rb"): cannot open the connection</code></pre>
</div>
<p>Now we can see we have this json data in a dataframe format. For
consistency with the rest of the lesson, let‚Äôs coerce it to be a tibble
and use <code>glimpse</code> to take a peek inside (these functions were
loaded by <code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>):</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span> <span class="op">&lt;-</span> <span class="va">json_data</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'json_data' not found</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">json_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'json_data' not found</code></pre>
</div>
<p>Looking good, but you might notice that actually we have a variable,
<em>F_liv</em> that is a list of dataframes! It is very important to
know what you are expecting from your data to be able to look for things
like this. For example, if you are getting your JSON from an API, have a
look at the API documentation, so you know what to look for.</p>
<p>So what can we do about this column of dataframes? Well first things
first, we can example each one. For example to access the dataframe in
the first row, we can use the bracket (<code>[</code>) subsetting. Here
we use single bracket, but you could also use double bracket
(<code>[[</code>). The <code>[[</code> form allows only a single element
to be selected using integer or character indices, whereas
<code>[</code> allows indexing by vectors.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span><span class="op">$</span><span class="va">F_liv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'json_data' not found</code></pre>
</div>
<p>We can also choose to view the nested dataframes at all the rows of
our main dataframe where a particular condition is met (for example
where the value for the variable <em>C06_rooms</em> is equal to 4):</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_data</span><span class="op">$</span><span class="va">F_liv</span><span class="op">[</span><span class="fu">which</span><span class="op">(</span><span class="va">json_data</span><span class="op">$</span><span class="va">C06_rooms</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'json_data' not found</code></pre>
</div>
</section><section id="write-the-json-file-to-csv"><h2 class="section-heading">Write the JSON file to csv<a class="anchor" aria-label="anchor" href="#write-the-json-file-to-csv"></a>
</h2>
<hr class="half-width">
<p>If we try to write our json_data dataframe to a csv as we would
usuall in a regular dataframe, we will get an error that tells us we
have an ‚Äúunimplemented type ‚Äòlist‚Äô in ‚ÄòEncodeElement‚Äô‚Äù. This is because
of the columns in our dataframes which are lists, or nested dataframes.
You can try yourself:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">json_data</span>, file <span class="op">=</span> <span class="st">"SAFI_from_JSON.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>To write out as a csv, we will need to ‚Äúflatten‚Äù these columns. One
thing you can do to achieve this is to turn all of the columns of your
dataframe to ‚Äúcharacter‚Äù types.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flattened_json_data</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">json_data</span>,<span class="fl">2</span>,<span class="va">as.character</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'json_data' not found</code></pre>
</div>
<p>Now you can write this to a csv file:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">flattened_json_data</span>, file <span class="op">=</span> <span class="st">"data_output/SAFI_from_JSON.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'flattened_json_data' not found</code></pre>
</div>
<p>Note: this means that when you read this csv back into R, the column
of the nested dataframes will now be read in as a character vector.
Converting it back to list to extract elements might be complicated, so
it is probably better to keep storing these data in a JSON format if you
will have to do this.</p>
<p>You can also write out the individual nested dataframes to a csv. For
example:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write_csv</span><span class="op">(</span><span class="va">json_data</span><span class="op">$</span><span class="va">F_liv</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, file <span class="op">=</span> <span class="st">"data_output/F_liv_row1.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'json_data' not found</code></pre>
</div>
<p>{% include links.md %}</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries/workbench-template-md/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries/workbench-template-md/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-md/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-md/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-md/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, KUB Datalab",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-md/instructor/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-md/instructor/aio.html",
  "dateCreated": "2023-12-20",
  "dateModified": "2023-12-20",
  "datePublished": "2023-12-20"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

